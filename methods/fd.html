

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="Vitis, library, Database, Quantitative Finance, Vision, Data Compression, Security, Solver, BLAS, Hardware, xfOpenCV, xfdatabase, xffintech, xfcompression, xfsecurity, xfsolver, xfblas, xfhardware"/>
<meta name="description" content="Vitis software development platform includes an extensive set of open-source, performance-optimized libraries that offer out-of-the-box acceleration with minimal to zero-code changes to your existing applications, without the need to reimplement your algorithms from scratch to harness the benefits of Xilinx adaptive compute."/>
<meta name="xlnxdocumentclass" content="Document"> 
<meta name="xlnxdocumenttypes" content="Tutorials"> 
<!-- Header information provided by Emily-->
    <meta name="Language" content="en">
    <meta name="Location" content="us">
    <link rel="icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
  
  <title>Finite Difference Methods &mdash; Vitis Quantitative Finance Library v2019.2 documentation</title>
  
<!-- Header information provided by Emily-->
    <meta name="apple-itunes-app" content="app-id=1063287962">
    <meta name="google-play-app" content="app-id=com.marketing.xilinxgo">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="https://kit.fontawesome.com/d3dd8c60ed.js"></script>
    
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/header-footer.min.css" type="text/css">
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all.min.css" type="text/css">
    
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/header-footer.min.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css">
  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Binomial Tree, Cox-Ross-Rubinstein, Method" href="bt-crr.html" />
    <link rel="prev" title="Monte Carlo Simulation" href="mc.html" /> 
</head>

<body class="wy-body-for-nav">
<div class="xilinx-bs3">
    <noindex>
        <header data-component="header">
            <nav class="navbar navbar-default">
                <div class="container main-nav">
                    <div class="row">
                        <div class="col-xs-5 col-sm-2 logo-column">
                            <div class="logo">
                                <a href="https://www.xilinx.com/">
                                    <img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc" />
                                </a>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 navbar-column">
                            <div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
                                <ul class="nav navbar-nav nav-justified">
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://developer.xilinx.com/">
                                            Developers
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://www.xilinx.com/support.html">
                                            Support
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://forums.xilinx.com/">
                                            Forums
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="mini-nav col-sm-2">
                            <button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
        </header>
    </noindex>
</div>
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Vitis Quantitative Finance Library
          

          
          </a>

          
            
            
              <div class="version">
                2019.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html#trademark-notice">Trademark Notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rel.html">Release Note</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../models_and_methods.html">Pricing Models and Numerical Methods</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../models_and_methods.html#models">Models</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../models_and_methods.html#numerical-methods">Numerical Methods</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mc.html">Monte Carlo Simulation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Finite Difference Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementation">Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bt-crr.html">Binomial Tree, Cox-Ross-Rubinstein, Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="tree.html">Internal Design of Tree Lattice</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models_and_methods.html#closed-form-solution-methods">Closed-Form Solution Methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guide_L1/L1.html">L1 Module User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_L2/L2.html">L2 Kernel User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide_L3/L3.html">L3 Overlay User Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmark Result</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmark/benchmark.html">Quality and Performance</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Vitis Quantitative Finance Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../models_and_methods.html">Pricing Models and Numerical Methods</a> &raquo;</li>
        
      <li>Finite Difference Methods</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="finite-difference-methods">
<h1>Finite Difference Methods<a class="headerlink" href="#finite-difference-methods" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Finite Difference Methods are a family of numerical techniques to solve partial differential equations (PDEs). They do this by discretizing the continuous equation in the spatial dimensions (forming a multidimensional grid), and then iteratively evolving the system over a series of N discrete time steps. The result is a discrete solution for each individual grid point.</p>
<p>In the provided solver, the PDE is the Heston Pricing Model <a class="reference internal" href="../models/HT.html#heston1993" id="id1">[HESTON1993]</a>. Using the naming conventions of Hout &amp; Foulon <a class="reference internal" href="../models/HT.html#hout2010" id="id2">[HOUT2010]</a>, the PDE is given as:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial u}{\partial t} = \tfrac{1}{2}s^2v\frac{\partial^{2} u}{\partial s^2} + \rho\sigma sv\frac{\partial^{2} u}{\partial s\partial v} + \tfrac{1}{2}\sigma^2v\frac{\partial^{2} u}{\partial v^2} + (r_d - r_f)s\frac{\partial u}{\partial s} + \kappa(\eta - v)\frac{\partial u}{\partial v} - r_d u\]</div>
<p>Where:</p>
<p><span class="math notranslate nohighlight">\(u\)</span> - the price of the European option;</p>
<p><span class="math notranslate nohighlight">\(s\)</span> - the underlying price of the asset;</p>
<p><span class="math notranslate nohighlight">\(v\)</span> - the volatility of the underlying price;</p>
<p><span class="math notranslate nohighlight">\(\sigma\)</span> - the volatility of the volatility;</p>
<p><span class="math notranslate nohighlight">\(\rho\)</span> - the correlation of Weiner processes;</p>
<p><span class="math notranslate nohighlight">\(\kappa\)</span> - the mean-reversion rate;</p>
<p><span class="math notranslate nohighlight">\(\eta\)</span> - the long term mean.</p>
<p>The Heston PDE then describes the evolution of an option price over time (<span class="math notranslate nohighlight">\(t\)</span>) and a solution of this PDE results in the specific option price for an <span class="math notranslate nohighlight">\((s,v)\)</span> pair for a given maturity date <span class="math notranslate nohighlight">\(T\)</span>. The finite difference solver maps the <span class="math notranslate nohighlight">\((s,v)\)</span> pair onto a 2D discrete grid, and solves for option price <span class="math notranslate nohighlight">\(u(s,v)\)</span> after <span class="math notranslate nohighlight">\(N\)</span> time-steps.</p>
</div>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>The included implementation uses a Douglas <a class="reference external" href="https://en.wikipedia.org/wiki/Alternating_direction_implicit_method">Alternating Direction Implicit (ADI) method</a> to solve the PDE <a class="reference internal" href="#douglas1962" id="id3">[DOUGLAS1962]</a>. Implicit methods are needed to provide a stable and useful solution, and the Douglas solver is the most direct of these methods.</p>
<a class="reference internal image-reference" href="../_images/fd.png"><img alt="FD Heston Dataflow" class="align-center" src="../_images/fd.png" style="width: 100%;" /></a>
<div class="section" id="assumptions-limitations">
<h3>Assumptions/Limitations<a class="headerlink" href="#assumptions-limitations" title="Permalink to this headline">¶</a></h3>
<p>The following limitations apply to this implementation:</p>
<ul class="simple">
<li>The dividend yield term (<span class="math notranslate nohighlight">\(r_f\)</span> above) is fixed to zero;</li>
<li>Boundary conditions are fixed in time.</li>
</ul>
</div>
<div class="section" id="dataflow-description">
<h3>Dataflow Description<a class="headerlink" href="#dataflow-description" title="Permalink to this headline">¶</a></h3>
<div class="section" id="precalculate-algorithm-fixed-matrices">
<h4>Precalculate algorithm fixed matrices<a class="headerlink" href="#precalculate-algorithm-fixed-matrices" title="Permalink to this headline">¶</a></h4>
<p>A function in the host software generates the finite-difference grid (possibly non-uniform) and the <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, <span class="math notranslate nohighlight">\(\gamma\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span> coefficients based on the grid. These are converted into a set of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> matrices (in sparse form) and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> boundary vectors, plus modified forms of the <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> matrices for the tridiagonal and pentadiagonal solvers (the <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> matrices). The initial condition of the grid is also calculated on the host, and all of these cofficients are moved into the DDR memory on the Alveo card.</p>
<p>The following three steps are performed in hardware on the Alveo card for each timestep of the simulation.</p>
</div>
<div class="section" id="explicit-estimation-at-timestep-t">
<h4>Explicit estimation at timestep t<a class="headerlink" href="#explicit-estimation-at-timestep-t" title="Permalink to this headline">¶</a></h4>
<p>A direct estimate of the PDE at the next timestep is made using the current values for the grid coefficients.</p>
</div>
<div class="section" id="implicit-correction-in-s">
<h4>Implicit correction in s<a class="headerlink" href="#implicit-correction-in-s" title="Permalink to this headline">¶</a></h4>
<p>The estimate is corrected using the new values in the PDE in the s direction. This takes the form of a multiplication by a tridiagonal matrix and then a subsequent tridiagonal solve.</p>
</div>
<div class="section" id="implicit-correction-in-v">
<h4>Implicit correction in v<a class="headerlink" href="#implicit-correction-in-v" title="Permalink to this headline">¶</a></h4>
<p>The estimate is then corrected using the new values in the PDE in the v direction. This takes the form of a multiplication by a pentadiagonal matrix and then a subsequent pentadiagonal solve.</p>
</div>
<div class="section" id="extract-price-grid">
<h4>Extract price grid<a class="headerlink" href="#extract-price-grid" title="Permalink to this headline">¶</a></h4>
<p>On completion of the simulation of all timesteps on the Alveo card, the host moves the final grid values back from the DDR memory and then extracts the final pricing information from those grid values.</p>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="heston1993" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[HESTON1993]</a></td><td>Heston, “A closed-form solution for options with stochastic volatility with applications to bond and currency options”, Rev. Finan. Stud. Vol. 6 (1993)</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hout2010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[HOUT2010]</a></td><td>Hout and Foulon, “ADI Finite Difference Schemes for Option Pricing in the Heston Model with correlation”, International Journal of Numerical Analysis and Modeling, Vol 7, Number 2 (2010).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="douglas1962" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[DOUGLAS1962]</a></td><td>Douglas Jr., J, “Alternating direction methods for three space variables”, Numerische Mathematik, 4(1), pp41-63 (1962).</td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bt-crr.html" class="btn btn-neutral float-right" title="Binomial Tree, Cox-Ross-Rubinstein, Method" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mc.html" class="btn btn-neutral float-left" title="Monte Carlo Simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p>
        
        &copy; Copyright 2019, Xilinx

    </p>
  </div>
<!--
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 
-->
</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>