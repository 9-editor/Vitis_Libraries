

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>namespace details &mdash; XF Security Library 1.0 pre-alpha documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/xilinx-favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> XF Security Library
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html#trademark-notice">Trademark Notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Note</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guide_L1/hw_guide.html">L1 Module User Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmark Result</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmark/result.html">Benchmark Result</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">XF Security Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>namespace details</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/rst_L1/namespace_xf_security_details.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="namespace-details">
<span id="cid-xf-security-details"></span><span id="doxid-namespacexf-1-1security-1-1details"></span><span id="index-0"></span><h1>namespace details<a class="headerlink" href="#namespace-details" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<pre class="highlight overview-code-block literal-block" id="cid-xf-security-details-sha256-iter">
<span id="doxid-namespacexf-1-1security-1-1details-1af66f36cfce4e837f4046ca508e8860af"></span><span id="cid-xf-security-details-generatemsgschedule"></span><span id="doxid-namespacexf-1-1security-1-1details-1aadc7ac5db009149af8e764ff3f81e8d2"></span><span id="cid-xf-security-details-dup-strm"></span><span id="doxid-namespacexf-1-1security-1-1details-1af07f929189ad7b49b670e688681172b0"></span><span id="cid-xf-security-details-dupstrm"></span><span id="doxid-namespacexf-1-1security-1-1details-1a61034df6ae150d9438dc5de666ab3f20"></span><span id="cid-xf-security-details-blocktypechacha"></span><span id="doxid-namespacexf-1-1security-1-1details-1a07222f2e1eeb318273a4b22a8c32b3dc"></span><span></span><span class="c1">// typedefs</span>

<span class="k">typedef</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">512</span><span class="o">&gt;</span> <span class="n">blockTypeChacha</span>

<span class="c1">// structs</span>

<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_details_SHA256Block.html#doxid-structxf-1-1security-1-1details-1-1-s-h-a256-block"><span class="std std-ref">SHA256Block</span></a><span></span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_details_blockType.html#doxid-structxf-1-1security-1-1details-1-1block-type"><span class="std std-ref">blockType</span></a><span></span>

<span class="k">template</span> <span class="o">&lt;&gt;</span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_details_sha256_digest_config.html#doxid-structxf-1-1security-1-1details-1-1sha256-digest-config-3-01true-01-4"><span class="std std-ref">sha256_digest_config &lt;true&gt;</span></a><span></span>

<span class="k">template</span> <span class="o">&lt;</span><span class="kt">bool</span> <span class="n">do_sha224</span><span class="o">&gt;</span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_details_sha256_digest_config-2.html#doxid-structxf-1-1security-1-1details-1-1sha256-digest-config"><span class="std std-ref">sha256_digest_config</span></a><span></span>

<span class="k">template</span> <span class="o">&lt;&gt;</span>
<span class="k">struct</span> <a class="reference internal" href="struct_xf_security_details_sha256_digest_config-3.html#doxid-structxf-1-1security-1-1details-1-1sha256-digest-config-3-01false-01-4"><span class="std std-ref">sha256_digest_config &lt;false&gt;</span></a>
</pre>
<div class="section" id="generateblock">
<span id="cid-xf-security-details-generateblock"></span><span id="doxid-namespacexf-1-1security-1-1details-1a8be2bcb760121d10c7c9245913cd6886"></span><h2>generateBlock<a class="headerlink" href="#generateblock" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">64</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">generateBlock</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">key_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">key_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_details_blockType.html#doxid-structxf-1-1security-1-1details-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_len_out_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">key_len_out_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate 1024-bit processing blocks by padding (pipeline).</p>
<p>The algorithm reference is : “The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)”. The optimization goal of this function is to yield a 1024-bit block per cycle.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>Bit width of the message words in block, default value is 64.</td>
</tr>
<tr class="row-even"><td>msg_strm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-odd"><td>msg_len_strm</td>
<td>Message length in byte (0 &lt;= msg_len &lt;= 2^128).</td>
</tr>
<tr class="row-even"><td>key_strm</td>
<td>The optional key.</td>
</tr>
<tr class="row-odd"><td>key_len_strm</td>
<td>Key length in byte (0 &lt;= key_len &lt;= 64).</td>
</tr>
<tr class="row-even"><td>end_len_strm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-odd"><td>blk_strm</td>
<td>The 1024-bit hash block.</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
<tr class="row-even"><td>msg_len_out_strm</td>
<td>Message length pass on to the digest process.</td>
</tr>
<tr class="row-odd"><td>key_len_out_strm</td>
<td>Key length pass on to the digest process.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rotr">
<span id="cid-xf-security-details-rotr"></span><span id="doxid-namespacexf-1-1security-1-1details-1af9bf62640e08b903458c6249619c819b"></span><h2>ROTR<a class="headerlink" href="#rotr" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">ROTR</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">)</span>
</pre>
<p>The implementation of rotate right (circular right shift) operation.</p>
<p>The algorithm reference is : “The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be rotated.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="g">
<span id="cid-xf-security-details-g"></span><span id="doxid-namespacexf-1-1security-1-1details-1ac56ea1e43d2c767528dd1cd7e3212147"></span><h2>G<a class="headerlink" href="#g" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">64</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">G</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">v</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">y</span>
    <span class="p">)</span>
</pre>
<p>Mixing function G as defined in standard.</p>
<p>The algorithm reference is : “The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Bit</td>
<td>width of the words, default value is 64.</td>
</tr>
<tr class="row-even"><td>v</td>
<td>Working vector.</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>The first index.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second index.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third index.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>the fourth index.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>The first input working word.</td>
</tr>
<tr class="row-even"><td>y</td>
<td>The second input working word.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="halfmixing">
<span id="cid-xf-security-details-halfmixing"></span><span id="doxid-namespacexf-1-1security-1-1details-1a5f34b33efe5aa6ae657dde4879c9396b"></span><h2>halfMixing<a class="headerlink" href="#halfmixing" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">64</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">halfMixing</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">v</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi0</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi1</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi2</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi3</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi4</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi5</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi6</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi7</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi8</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi9</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi10</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi11</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi12</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi13</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi14</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">vi15</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">m</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">mi0</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">mi1</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">mi2</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">mi3</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">mi4</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">mi5</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">mi6</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span> <span class="n">mi7</span>
    <span class="p">)</span>
</pre>
<p>Mixing 2 halves for unroll purpose.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Bit</td>
<td>width of the words, default value is 64.</td>
</tr>
<tr class="row-even"><td>v</td>
<td>Working vector.</td>
</tr>
<tr class="row-odd"><td>vi0</td>
<td>The 1st index for working vector.</td>
</tr>
<tr class="row-even"><td>vi1</td>
<td>The 2nd index for working vector.</td>
</tr>
<tr class="row-odd"><td>vi2</td>
<td>The 3rd index for working vector.</td>
</tr>
<tr class="row-even"><td>vi3</td>
<td>The 4th index for working vector.</td>
</tr>
<tr class="row-odd"><td>vi4</td>
<td>The 5th index for working vector.</td>
</tr>
<tr class="row-even"><td>vi5</td>
<td>The 6th index for working vector.</td>
</tr>
<tr class="row-odd"><td>vi6</td>
<td>The 7th index for working vector.</td>
</tr>
<tr class="row-even"><td>vi7</td>
<td>The 8th index for working vector.</td>
</tr>
<tr class="row-odd"><td>vi8</td>
<td>The 9th index for working vector.</td>
</tr>
<tr class="row-even"><td>vi9</td>
<td>The 10th index for working vector.</td>
</tr>
<tr class="row-odd"><td>vi10</td>
<td>The 11th index for working vector.</td>
</tr>
<tr class="row-even"><td>vi11</td>
<td>The 12th index for working vector.</td>
</tr>
<tr class="row-odd"><td>vi12</td>
<td>The 13th index for working vector.</td>
</tr>
<tr class="row-even"><td>vi13</td>
<td>The 14th index for working vector.</td>
</tr>
<tr class="row-odd"><td>vi14</td>
<td>The 15th index for working vector.</td>
</tr>
<tr class="row-even"><td>vi15</td>
<td>The 16th index for working vector.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>Message vector.</td>
</tr>
<tr class="row-even"><td>mi0</td>
<td>The 1st index for message vector.</td>
</tr>
<tr class="row-odd"><td>mi1</td>
<td>The 2nd index for message vector.</td>
</tr>
<tr class="row-even"><td>mi2</td>
<td>The 3rd index for message vector.</td>
</tr>
<tr class="row-odd"><td>mi3</td>
<td>The 4th index for message vector.</td>
</tr>
<tr class="row-even"><td>mi4</td>
<td>The 5th index for message vector.</td>
</tr>
<tr class="row-odd"><td>mi5</td>
<td>The 6th index for message vector.</td>
</tr>
<tr class="row-even"><td>mi6</td>
<td>The 7th index for message vector.</td>
</tr>
<tr class="row-odd"><td>mi7</td>
<td>The 8th index for message vector.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="compress">
<span id="cid-xf-security-details-compress"></span><span id="doxid-namespacexf-1-1security-1-1details-1ac308d30cef1463409f9f72d078f55c1e"></span><h2>Compress<a class="headerlink" href="#compress" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">round</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">Compress</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">h</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">blake2b_iv</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">m</span> <span class="p">[</span><span class="mi">16</span><span class="p">],</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">t</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">last</span>
    <span class="p">)</span>
</pre>
<p>Compression function F as defined in standard.</p>
<p>The optimization goal of this function is for better performance. The algorithm reference is : “The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>Bit width of the words, default value is 64.</td>
</tr>
<tr class="row-even"><td>round</td>
<td>Number of rounds, 12 for BLAKE2b and 10 for BLAKE2s.</td>
</tr>
<tr class="row-odd"><td>h</td>
<td>State vector.</td>
</tr>
<tr class="row-even"><td>blake2b_iv</td>
<td>Initialization vector.</td>
</tr>
<tr class="row-odd"><td>m</td>
<td>Message block vector.</td>
</tr>
<tr class="row-even"><td>t</td>
<td>Offset counter.</td>
</tr>
<tr class="row-odd"><td>last</td>
<td>Final block indicator.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="blake2bdigest">
<span id="cid-xf-security-details-blake2bdigest"></span><span id="doxid-namespacexf-1-1security-1-1details-1ad362b9b1b268f268c869fa907ffa19f9"></span><h2>blake2bDigest<a class="headerlink" href="#blake2bdigest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/blake2b.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">blake2bDigest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_details_blockType.html#doxid-structxf-1-1security-1-1details-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">key_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">out_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the digest prcoess of BLAKE2.</p>
<p>The algorithm reference is : “The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)”. The optimization goal of this function is for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>Bit width of the words, default value is 64.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>The 512-bit hash block.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
<tr class="row-odd"><td>key_len_strm</td>
<td>Key length in byte (0 &lt;= key_len &lt;= 64).</td>
</tr>
<tr class="row-even"><td>msg_len_strm</td>
<td>Message length in byte (0 &lt;= msg_len &lt;= 2^128).</td>
</tr>
<tr class="row-odd"><td>out_len_strm</td>
<td>Result hash value length in byte (0 &lt; out_len &lt; 64).</td>
</tr>
<tr class="row-even"><td>digest_strm</td>
<td>The full digest stream (result is stored in the lower out_len bytes).</td>
</tr>
<tr class="row-odd"><td>end_digest_strm</td>
<td>Flag to signal the end of the result.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescbcencrypt">
<span id="cid-xf-security-details-aescbcencrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1acd9e497ba44d2fcd6155391336e8e64e"></span><h2>aesCbcEncrypt<a class="headerlink" href="#aescbcencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cbc.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCbcEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCbcEncrypt is CBC encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescbcdecrypt">
<span id="cid-xf-security-details-aescbcdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a7b5da858c0d8139e0264c6b1e3958e09"></span><h2>aesCbcDecrypt<a class="headerlink" href="#aescbcdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cbc.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCbcDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCbcDecrypt is CBC decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="formatting">
<span id="cid-xf-security-details-formatting"></span><span id="doxid-namespacexf-1-1security-1-1details-1a0fdf7464d2112a88ceeebafe6ea8e578"></span><h2>formatting<a class="headerlink" href="#formatting" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_t</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_q</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">formatting</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">blockStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outLenADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outNonceStrm</span>
    <span class="p">)</span>
</pre>
<p>Impletmentation of formatting function as specified in standard.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_t</td>
<td>Length of the MAC in byte, t is an element of {4, 6, 8, 10, 12, 14, 16}.</td>
</tr>
<tr class="row-even"><td>_q</td>
<td>Length in byte of the binary representation of the length of the payload in byte, q is an element of {2, 3, 4, 5, 6, 7, 8}.</td>
</tr>
<tr class="row-odd"><td>ADStrm</td>
<td>Associated data stream.</td>
</tr>
<tr class="row-even"><td>nonceStrm</td>
<td>The nonce stream.</td>
</tr>
<tr class="row-odd"><td>lenADStrm</td>
<td>Length of associated data in byte.</td>
</tr>
<tr class="row-even"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-odd"><td>endLenStrm</td>
<td>Flag to signal the end of the length streams.</td>
</tr>
<tr class="row-even"><td>blockStrm</td>
<td>Block stream of the formatted input as specified in reference.</td>
</tr>
<tr class="row-odd"><td>outLenADStrm</td>
<td>Pass on the length of associated data to CBC-MAC.</td>
</tr>
<tr class="row-even"><td>outNonceStrm</td>
<td>Pass on the nonce to CTR.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesctrencrypt">
<span id="cid-xf-security-details-aesctrencrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1ae25f842c4fac08ac46ae09b34cb52f80"></span><h2>aesCtrEncrypt<a class="headerlink" href="#aesctrencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_q</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCtrEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outPayloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outCipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">S0Strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenCphStrm</span>
    <span class="p">)</span>
</pre>
<p>Implementation of CTR encryption part in CCM.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_q</td>
<td>Length in byte of the binary representation of the length of the payload in byte, q is an element of {2, 3, 4, 5, 6, 7, 8}.</td>
</tr>
<tr class="row-even"><td>_keyWidth</td>
<td>Bit-width of the cipher key, typically 128, 192, or 256 for AES.</td>
</tr>
<tr class="row-odd"><td>payloadStrm</td>
<td>Input block stream text to be encrypted.</td>
</tr>
<tr class="row-even"><td>cipherkeyStrm</td>
<td>Input cipher key used in encryption.</td>
</tr>
<tr class="row-odd"><td>nonceStrm</td>
<td>The nonce stream.</td>
</tr>
<tr class="row-even"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-odd"><td>endLenPldStrm</td>
<td>Flag to signal the end of the payload length stream.</td>
</tr>
<tr class="row-even"><td>outPayloadStrm</td>
<td>Pass on the payload stream to CBC-MAC.</td>
</tr>
<tr class="row-odd"><td>outCipherkeyStrm</td>
<td>Pass on the cipherkey to CBC-MAC.</td>
</tr>
<tr class="row-even"><td>S0Strm</td>
<td>First cipher used to generate the MAC.</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>Output encrypted block stream text.</td>
</tr>
<tr class="row-even"><td>lenCphStrm</td>
<td>Length of cipher in byte.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesctrdecrypt">
<span id="cid-xf-security-details-aesctrdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a016713797b99badb9b9432a40ec99c0d"></span><h2>aesCtrDecrypt<a class="headerlink" href="#aesctrdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_q</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCtrDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outPayloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">outCipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">S0Strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenCphStrm</span>
    <span class="p">)</span>
</pre>
<p>Implementation of CTR decryption part in CCM.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_q</td>
<td>Length in byte of the binary representation of the length of the payload in byte, q is an element of {2, 3, 4, 5, 6, 7, 8}.</td>
</tr>
<tr class="row-even"><td>_keyWidth</td>
<td>Bit-width of the cipher key, typically 128, 192, or 256 for AES.</td>
</tr>
<tr class="row-odd"><td>payloadStrm</td>
<td>Input block stream text to be decrypted.</td>
</tr>
<tr class="row-even"><td>cipherkeyStrm</td>
<td>Input cipher key used in decryption.</td>
</tr>
<tr class="row-odd"><td>nonceStrm</td>
<td>The nonce stream.</td>
</tr>
<tr class="row-even"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-odd"><td>endLenPldStrm</td>
<td>Flag to signal the end of the payload length stream.</td>
</tr>
<tr class="row-even"><td>outPayloadStrm</td>
<td>Pass on the payload stream to CBC-MAC.</td>
</tr>
<tr class="row-odd"><td>outCipherkeyStrm</td>
<td>Pass on the cipherkey to CBC-MAC.</td>
</tr>
<tr class="row-even"><td>S0Strm</td>
<td>First cipher used to generate the MAC.</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>Output decrypted block stream text.</td>
</tr>
<tr class="row-even"><td>lenCphStrm</td>
<td>Length of cipher in byte.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cbc-mac">
<span id="cid-xf-security-details-cbc-mac"></span><span id="doxid-namespacexf-1-1security-1-1details-1af1d768278ab714ff7283448275a71156"></span><h2>CBC_MAC<a class="headerlink" href="#cbc-mac" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_t</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">CBC_MAC</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">blockStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">S0Strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">_t</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tagStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endTagStrm</span>
    <span class="p">)</span>
</pre>
<p>Impletmentation of CBC-MAC in CCM.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_t</td>
<td>Length of the MAC in byte, t is an element of {4, 6, 8, 10, 12, 14, 16}.</td>
</tr>
<tr class="row-even"><td>_keyWidth</td>
<td>Bit-width of the cipher key, typically 128, 192, or 256 for AES.</td>
</tr>
<tr class="row-odd"><td>payloadStrm</td>
<td>Input block stream text.</td>
</tr>
<tr class="row-even"><td>lenADStrm</td>
<td>Length of associated data in byte.</td>
</tr>
<tr class="row-odd"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-even"><td>blockStrm</td>
<td>Block stream of the formatted input as specified in reference.</td>
</tr>
<tr class="row-odd"><td>cipherkeyStrm</td>
<td>Input cipher key, typically 128, 192, or 256 for AES.</td>
</tr>
<tr class="row-even"><td>S0Strm</td>
<td>First cipher used to generate the MAC.</td>
</tr>
<tr class="row-odd"><td>endLenStrm</td>
<td>Flag to signal the end of the length streams.</td>
</tr>
<tr class="row-even"><td>tagStrm</td>
<td>The MAC.</td>
</tr>
<tr class="row-odd"><td>endTagStrm</td>
<td>Flag to signal the end of the MAC stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesccmencrypt">
<span id="cid-xf-security-details-aesccmencrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a88f49bebbe401cc73a6b42570c30bc8c"></span><h2>aesCcmEncrypt<a class="headerlink" href="#aesccmencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_t</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_q</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCcmEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenCphStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">_t</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tagStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endTagStrm</span>
    <span class="p">)</span>
</pre>
<p>aesCcmEncrypt is CCM encryption mode with AES single block cipher.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_t</td>
<td>Length of the MAC in byte, t is an element of {4, 6, 8, 10, 12, 14, 16}.</td>
</tr>
<tr class="row-even"><td>_q</td>
<td>Length in byte of the binary representation of the length of the payload in byte, q is an element of {2, 3, 4, 5, 6, 7, 8}.</td>
</tr>
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>payloadStrm</td>
<td>Input block stream text to be encrypted.</td>
</tr>
<tr class="row-odd"><td>cipherkeyStrm</td>
<td>Input cipher key used in encryption.</td>
</tr>
<tr class="row-even"><td>nonceStrm</td>
<td>The nonce stream.</td>
</tr>
<tr class="row-odd"><td>ADStrm</td>
<td>Associated data stream.</td>
</tr>
<tr class="row-even"><td>lenADStrm</td>
<td>Length of associated data in byte.</td>
</tr>
<tr class="row-odd"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-even"><td>endLenStrm</td>
<td>Flag to signal the end of the length streams.</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>Output encrypted block stream text.</td>
</tr>
<tr class="row-even"><td>lenCphStrm</td>
<td>Length of cipher in byte.</td>
</tr>
<tr class="row-odd"><td>tagStrm</td>
<td>The MAC stream.</td>
</tr>
<tr class="row-even"><td>endTagStrm</td>
<td>Flag to signal the end of the MAC stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesccmdecrypt">
<span id="cid-xf-security-details-aesccmdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a7896c0e187cddeecf323260383ebe704"></span><h2>aesCcmDecrypt<a class="headerlink" href="#aesccmdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ccm.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_t</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_q</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCcmDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkeyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span> <span class="p">(</span><span class="mi">15</span><span class="o">-</span><span class="n">_q</span><span class="p">)</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenADStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenCphStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">_t</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tagStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endTagStrm</span>
    <span class="p">)</span>
</pre>
<p>aesCcmDecrypt is CCM decryption mode with AES single block cipher.</p>
<p>The algorithm reference is: “Recommendation for Block Cipher Modes of Operation: The CCM Mode for Authentication and
Confidentiality” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_t</td>
<td>Length of the MAC in byte, t is an element of {4, 6, 8, 10, 12, 14, 16}.</td>
</tr>
<tr class="row-even"><td>_q</td>
<td>Length in byte of the binary representation of the length of the payload in byte, q is an element of {2, 3, 4, 5, 6, 7, 8}.</td>
</tr>
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>payloadStrm</td>
<td>Input block stream text to be decrypted.</td>
</tr>
<tr class="row-odd"><td>cipherkeyStrm</td>
<td>Input cipher key used in decryption.</td>
</tr>
<tr class="row-even"><td>nonceStrm</td>
<td>The nonce stream.</td>
</tr>
<tr class="row-odd"><td>ADStrm</td>
<td>Associated data stream.</td>
</tr>
<tr class="row-even"><td>lenADStrm</td>
<td>Length of associated data in byte.</td>
</tr>
<tr class="row-odd"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-even"><td>endLenStrm</td>
<td>Flag to signal the end of the length streams.</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>Output decrypted block stream text.</td>
</tr>
<tr class="row-even"><td>lenCphStrm</td>
<td>Length of cipher in byte.</td>
</tr>
<tr class="row-odd"><td>tagStrm</td>
<td>The MAC stream.</td>
</tr>
<tr class="row-even"><td>endTagStrm</td>
<td>Flag to signal the end of the MAC stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb1encrypt">
<span id="cid-xf-security-details-aescfb1encrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a3c3cf684300ca636dd40aabe8ddb1412"></span><h2>aesCfb1Encrypt<a class="headerlink" href="#aescfb1encrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb1Encrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb1Encrypt is CFB1 encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb1decrypt">
<span id="cid-xf-security-details-aescfb1decrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a551420cf3d3a1f6cac06ef3f34d8ed80"></span><h2>aesCfb1Decrypt<a class="headerlink" href="#aescfb1decrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb1Decrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb1Decrypt is CFB1 decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_strm</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb8encrypt">
<span id="cid-xf-security-details-aescfb8encrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a195f42f9320e96043d277575bbbafc16"></span><h2>aesCfb8Encrypt<a class="headerlink" href="#aescfb8encrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb8Encrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb8Encrypt is CFB8 encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb8decrypt">
<span id="cid-xf-security-details-aescfb8decrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a09dd351257531100a67d8d7ea0f9291b"></span><h2>aesCfb8Decrypt<a class="headerlink" href="#aescfb8decrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb8Decrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb8Decrypt is CFB8 decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_strm</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb128encrypt">
<span id="cid-xf-security-details-aescfb128encrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a35e8f3407d053b1b6c02c035dd8c42b4"></span><h2>aesCfb128Encrypt<a class="headerlink" href="#aescfb128encrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb128Encrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb128Encrypt is CFB128 encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aescfb128decrypt">
<span id="cid-xf-security-details-aescfb128decrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1aedeed8606323e776e455a276b7ce6a04"></span><h2>aesCfb128Decrypt<a class="headerlink" href="#aescfb128decrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/cfb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCfb128Decrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCfb128Decrypt is CFB128 decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_strm</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="chachaencrpt">
<span id="cid-xf-security-details-chachaencrpt"></span><span id="doxid-namespacexf-1-1security-1-1details-1ac3c594a08d3625a5547c750ccc928c7b"></span><h2>chachaEncrpt<a class="headerlink" href="#chachaencrpt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/chacha20.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">chachaEncrpt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="#doxid-namespacexf-1-1security-1-1details-1a07222f2e1eeb318273a4b22a8c32b3dc"><span class="std std-ref">blockTypeChacha</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">stateStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="#doxid-namespacexf-1-1security-1-1details-1a07222f2e1eeb318273a4b22a8c32b3dc"><span class="std std-ref">blockTypeChacha</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">packPlainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">numPackPlainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ePackPlainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="#doxid-namespacexf-1-1security-1-1details-1a07222f2e1eeb318273a4b22a8c32b3dc"><span class="std std-ref">blockTypeChacha</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">packCipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">numPackCipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ePackCipherStrm</span>
    <span class="p">)</span>
</pre>
<p>chachaEncrpt encrpyts the plain text.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>stateStrm</td>
<td>input state stream only once</td>
</tr>
<tr class="row-even"><td>packPlainStrm</td>
<td>input plain text stream</td>
</tr>
<tr class="row-odd"><td>numPackPlainStrm</td>
<td>the number of effective bytes in each packed data</td>
</tr>
<tr class="row-even"><td>ePackPlainStrm</td>
<td>the end flag of packPlainStrm</td>
</tr>
<tr class="row-odd"><td>packCipherStrm</td>
<td>output cipher stream</td>
</tr>
<tr class="row-even"><td>numPackCipherStrm</td>
<td>the number of effective bytes in each packed data</td>
</tr>
<tr class="row-odd"><td>ePackCipherStrm</td>
<td>the end flag of packCipherStrm</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-details-generateblock-2">
<span id="doxid-namespacexf-1-1security-1-1details-1ae0a3595212924936fc38a59b16eaec43"></span><span id="id1"></span><h2>generateBlock<a class="headerlink" href="#cid-xf-security-details-generateblock-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/chacha20.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">generateBlock</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">256</span><span class="o">&gt;&gt;&amp;</span> <span class="n">keyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">counterNonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="#doxid-namespacexf-1-1security-1-1details-1a07222f2e1eeb318273a4b22a8c32b3dc"><span class="std std-ref">blockTypeChacha</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">stateStrm</span>
    <span class="p">)</span>
</pre>
<p>generateBlock generates the state matrix from initial key and counter. state matrix: s[0] s[1] s[2] s[3] s[4] s[5] s[6] s[7] s[8] s[9] s[10] s[11] s[12] s[13] s[14] s[15]</p>
<p>the layout of the data from counteStrm 0-31 bit: counter s[12] 32-63 bit: nonce1 s[13] 64-95 bit: nonce2 s[14] 96-127 bit: nonce3 s[15]</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>keyStrm</td>
<td>initial key</td>
</tr>
<tr class="row-even"><td>counterNonceStm</td>
<td>initial counter and nonce</td>
</tr>
<tr class="row-odd"><td>stateStrm</td>
<td>output state stream</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="packmsg">
<span id="cid-xf-security-details-packmsg"></span><span id="doxid-namespacexf-1-1security-1-1details-1a21342d4b6c28b0ee8b541b430c89ed34"></span><h2>packMsg<a class="headerlink" href="#packmsg" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/chacha20.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">packMsg</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ePlainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="#doxid-namespacexf-1-1security-1-1details-1a07222f2e1eeb318273a4b22a8c32b3dc"><span class="std std-ref">blockTypeChacha</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">packPlainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">numPackPlainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ePackPlainStrm</span>
    <span class="p">)</span>
</pre>
<p>packMsg converts a few of bytes to a big width data.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>plainStrm</td>
<td>input stream with byte</td>
</tr>
<tr class="row-even"><td>ePlainStrm</td>
<td>end of plainStrm</td>
</tr>
<tr class="row-odd"><td>packPlainStrm</td>
<td>output big width stream</td>
</tr>
<tr class="row-even"><td>numPackPlainStrm</td>
<td>the number of effective bytes in each packed data</td>
</tr>
<tr class="row-odd"><td>ePackPlainStrm</td>
<td>the end flag of packPlainStrm</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="convert2byte">
<span id="cid-xf-security-details-convert2byte"></span><span id="doxid-namespacexf-1-1security-1-1details-1a1c2da864d10e25d1bfcf7a64195fca09"></span><h2>convert2Byte<a class="headerlink" href="#convert2byte" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/chacha20.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">convert2Byte</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="#doxid-namespacexf-1-1security-1-1details-1a07222f2e1eeb318273a4b22a8c32b3dc"><span class="std std-ref">blockTypeChacha</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">packStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">numPackStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ePackStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">byteStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">eByteStrm</span>
    <span class="p">)</span>
</pre>
<p>convert2Byte converts big width data to a few of bytes.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>packStrm</td>
<td>a big width stream</td>
</tr>
<tr class="row-even"><td>numPackStrm</td>
<td>each element contains the number of effective bytes</td>
</tr>
<tr class="row-odd"><td>ePackStrm</td>
<td>the end flag of packStrm</td>
</tr>
<tr class="row-even"><td>byteStrm</td>
<td>output byte stream</td>
</tr>
<tr class="row-odd"><td>eByteStrm</td>
<td>the end flag of byteStrm</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="chacha20imp">
<span id="cid-xf-security-details-chacha20imp"></span><span id="doxid-namespacexf-1-1security-1-1details-1a3f1951467a9ff46a223c77ccc80b31d9"></span><h2>chacha20Imp<a class="headerlink" href="#chacha20imp" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/chacha20.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">chacha20Imp</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">256</span><span class="o">&gt;&gt;&amp;</span> <span class="n">keyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">counterNonceStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ePlainStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">eCipherStrm</span>
    <span class="p">)</span>
</pre>
<p>chacha20 is a function for stream ciphering</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>keyStrm</td>
<td>initail key</td>
</tr>
<tr class="row-even"><td>counterNonceStm</td>
<td>initial counter and nonce</td>
</tr>
<tr class="row-odd"><td>plainStrm</td>
<td>input plain text to be encrypted</td>
</tr>
<tr class="row-even"><td>ePlainStrm</td>
<td>the end flag of plainStrm</td>
</tr>
<tr class="row-odd"><td>cipherStrm</td>
<td>output encrypted text</td>
</tr>
<tr class="row-even"><td>eCipherStrm</td>
<td>the end flag of cipherStrm</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-details-aesctrencrypt-2">
<span id="doxid-namespacexf-1-1security-1-1details-1ae07ad3b9e18d8749754e7b1914711c21"></span><span id="id2"></span><h2>aesCtrEncrypt<a class="headerlink" href="#cid-xf-security-details-aesctrencrypt-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ctr.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCtrEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCtrEncrypt is CTR encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-details-aesctrdecrypt-2">
<span id="doxid-namespacexf-1-1security-1-1details-1a9ab35ac8a3b4dcb67c6daded1181d1c2"></span><span id="id3"></span><h2>aesCtrDecrypt<a class="headerlink" href="#cid-xf-security-details-aesctrdecrypt-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ctr.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesCtrDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesCtrDecrypt is CTR decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_strm</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesecbencrypt">
<span id="cid-xf-security-details-aesecbencrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a3831c1bb191a72d327fbb1d77f72abc6"></span><h2>aesEcbEncrypt<a class="headerlink" href="#aesecbencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ecb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesEcbEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesEcbEncrypt is ECB encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesecbdecrypt">
<span id="cid-xf-security-details-aesecbdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1ae56d1f897ebf63e46eef3c145b5b2fb3"></span><h2>aesEcbDecrypt<a class="headerlink" href="#aesecbdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ecb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesEcbDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesEcbDecrypt is ECB decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="preprocessing">
<span id="cid-xf-security-details-preprocessing"></span><span id="doxid-namespacexf-1-1security-1-1details-1a97de6aea5f185b3bbc1110b8d44f5d66"></span><h2>preProcessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">preProcessing</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_details_blockType.html#doxid-structxf-1-1security-1-1details-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate 512-bit processing blocks by padding and appending (pipeline).</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”. The optimization goal of this function is to yield a 512-bit block per cycle.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>msg_strm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>The message length in byte.</td>
</tr>
<tr class="row-odd"><td>end_len_strm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>The 512-bit hash block.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="f">
<span id="cid-xf-security-details-f"></span><span id="doxid-namespacexf-1-1security-1-1details-1a4ed47aeb7bbce0e05cd022266968a401"></span><h2>F<a class="headerlink" href="#f" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">F</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>Perform function F as defined in standard.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>x</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>y</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>z</td>
<td>The third 32-bit operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-details-g-2">
<span id="doxid-namespacexf-1-1security-1-1details-1ab39f5ae51b9e383d3eea44b1b92ac7fd"></span><span id="id4"></span><h2>G<a class="headerlink" href="#cid-xf-security-details-g-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">G</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>Perform function G as defined in standard.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>x</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>y</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>z</td>
<td>The third 32-bit operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="h">
<span id="cid-xf-security-details-h"></span><span id="doxid-namespacexf-1-1security-1-1details-1a2be905306e2c2b33c4e425a035788002"></span><h2>H<a class="headerlink" href="#h" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">H</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>Perform function H as defined in standard.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>x</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>y</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>z</td>
<td>The third 32-bit operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rotl">
<span id="cid-xf-security-details-rotl"></span><span id="doxid-namespacexf-1-1security-1-1details-1a970de8c8ba246fb16eeeb7b476744395"></span><h2>ROTL<a class="headerlink" href="#rotl" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">ROTL</span> <span class="p">(</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span>
    <span class="p">)</span>
</pre>
<p>The implementation of rotate left (circular left shift) operation.</p>
<p>The implementation of rotate left (circular left shift) operation. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 32.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be rotated.</td>
</tr>
<tr class="row-even"><td>w</td>
<td>The bit width of input x, default value is 32.</td>
</tr>
<tr class="row-odd"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>Word to be rotated.</td>
</tr>
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 32.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be rotated.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md4round1">
<span id="cid-xf-security-details-md4round1"></span><span id="doxid-namespacexf-1-1security-1-1details-1a20a9f7d47224cf6b98632f198085c3b3"></span><h2>MD4Round1<a class="headerlink" href="#md4round1" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD4Round1</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 1.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”. The operation is defined as : a = (a + F(b, c, d) + X[k]) &lt;&lt;&lt; s.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md4round2">
<span id="cid-xf-security-details-md4round2"></span><span id="doxid-namespacexf-1-1security-1-1details-1ae85105f732c50c28a5b798ca05218488"></span><h2>MD4Round2<a class="headerlink" href="#md4round2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD4Round2</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 2.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”. The operation is defined as : a = (a + G(b, c, d) + X[k] + 0x5a827999) &lt;&lt;&lt; s</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md4round3">
<span id="cid-xf-security-details-md4round3"></span><span id="doxid-namespacexf-1-1security-1-1details-1a028eb29a040ea578d325df2419cb1f86"></span><h2>MD4Round3<a class="headerlink" href="#md4round3" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD4Round3</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 3.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”. The operation is defined as : a = (a + H(b, c, d) + X[k] + 0x6ed9eba1) &lt;&lt;&lt; s</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md4digest">
<span id="cid-xf-security-details-md4digest"></span><span id="doxid-namespacexf-1-1security-1-1details-1a2adb2bc1599c7782927652ce2cb15001"></span><h2>MD4Digest<a class="headerlink" href="#md4digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md4.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD4Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_details_blockType.html#doxid-structxf-1-1security-1-1details-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the digest part of MD4.</p>
<p>The algorithm reference is : “The MD4 Message-Digest Algorithm”. The optimization goal of this function is for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>blk_strm</td>
<td>The 512-bit hash block.</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
<tr class="row-even"><td>digest_strm</td>
<td>The digest (fingerprint) stream.</td>
</tr>
<tr class="row-odd"><td>end_digest_strm</td>
<td>Flag to signal the end of the result.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="i">
<span id="cid-xf-security-details-i"></span><span id="doxid-namespacexf-1-1security-1-1details-1acc666b2bf029f8600ca8338b9ade5308"></span><h2>I<a class="headerlink" href="#i" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">I</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>Perform function I as defined in standard.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>x</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>y</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>z</td>
<td>The third 32-bit operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md5round1">
<span id="cid-xf-security-details-md5round1"></span><span id="doxid-namespacexf-1-1security-1-1details-1a8aad0f87e53721246d15f69c62c5c952"></span><h2>MD5Round1<a class="headerlink" href="#md5round1" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD5Round1</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">T</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 1.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”. The operation is defined as : a = b + ((a + F(b, c, d) + X + T) &lt;&lt;&lt; s).</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>T</td>
<td>the specific sine value.</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md5round2">
<span id="cid-xf-security-details-md5round2"></span><span id="doxid-namespacexf-1-1security-1-1details-1a5f8264d87fbbec143271cc46e8b1e373"></span><h2>MD5Round2<a class="headerlink" href="#md5round2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD5Round2</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">T</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 2.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”. The operation is defined as : a = b + ((a + G(b, c, d) + X + T) &lt;&lt;&lt; s).</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>T</td>
<td>the specific sine value.</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md5round3">
<span id="cid-xf-security-details-md5round3"></span><span id="doxid-namespacexf-1-1security-1-1details-1aeb5496b145940ec18c416f43f7624c34"></span><h2>MD5Round3<a class="headerlink" href="#md5round3" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD5Round3</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">T</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 3.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”. The operation is defined as : a = b + ((a + H(b, c, d) + X + T) &lt;&lt;&lt; s).</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>T</td>
<td>the specific sine value.</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md5round4">
<span id="cid-xf-security-details-md5round4"></span><span id="doxid-namespacexf-1-1security-1-1details-1a0a95ee6bf223865609af232afba27405"></span><h2>MD5Round4<a class="headerlink" href="#md5round4" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD5Round4</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&amp;</span> <span class="n">a</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">X</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;</span> <span class="n">T</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">s</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the function defined in round 4.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”. The operation is defined as : a = b + ((a + I(b, c, d) + X + T) &lt;&lt;&lt; s).</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>a</td>
<td>The first 32-bit operand.</td>
</tr>
<tr class="row-even"><td>b</td>
<td>The second 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>The third 32-bit operand.</td>
</tr>
<tr class="row-even"><td>d</td>
<td>The fourth 32-bit operand.</td>
</tr>
<tr class="row-odd"><td>X</td>
<td>The specific message word.</td>
</tr>
<tr class="row-even"><td>T</td>
<td>the specific sine value.</td>
</tr>
<tr class="row-odd"><td>s</td>
<td>Number of bits to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="md5digest">
<span id="cid-xf-security-details-md5digest"></span><span id="doxid-namespacexf-1-1security-1-1details-1a2ddf4cf6dc14376257ff7e17442672b6"></span><h2>MD5Digest<a class="headerlink" href="#md5digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/md5.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">MD5Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_details_blockType.html#doxid-structxf-1-1security-1-1details-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>The implementation of the digest part of MD5.</p>
<p>The algorithm reference is : “The MD5 Message-Digest Algorithm”. The optimization goal of this function is for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>blk_strm</td>
<td>The 512-bit hash block.</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
<tr class="row-even"><td>digest_strm</td>
<td>The digest (fingerprint) stream.</td>
</tr>
<tr class="row-odd"><td>end_digest_strm</td>
<td>Flag to signal the end of the result.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesofbencrypt">
<span id="cid-xf-security-details-aesofbencrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1aca8cb55fbef31d35daa39bd6bdedc185"></span><h2>aesOfbEncrypt<a class="headerlink" href="#aesofbencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ofb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesOfbEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span>
    <span class="p">)</span>
</pre>
<p>aesOfbEncrypt is OFB encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>initialization_vector</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Output encrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesofbdecrypt">
<span id="cid-xf-security-details-aesofbdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1ab8374ff37b115e73346542172406a128"></span><h2>aesOfbDecrypt<a class="headerlink" href="#aesofbdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/ofb.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesOfbDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">IV_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e</span>
    <span class="p">)</span>
</pre>
<p>aesOfbDecrypt is OFB decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “Recommendation for Block Cipher Modes of Operation - Methods and Techniques” The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext</td>
<td>Input block stream to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>cipherkey</td>
<td>Input cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-odd"><td>IV_strm</td>
<td>Initialization vector for the fisrt iteration of AES decrypition, 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="multoperator">
<span id="cid-xf-security-details-multoperator"></span><span id="doxid-namespacexf-1-1security-1-1details-1aa287aa18e11ee5285976ae925caaf740"></span><h2>multOperator<a class="headerlink" href="#multoperator" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/poly1305.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">264</span><span class="o">&gt;</span> <span class="n">multOperator</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">136</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;</span> <span class="n">B</span>
    <span class="p">)</span>
</pre>
<p>The implementation of large bit-width multiplication, the result is A * B. The optimization goal of this function to improve timing.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>A</td>
<td>The input multiplicand.</td>
</tr>
<tr class="row-even"><td>B</td>
<td>The input multiplier.</td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>The output product.</p>
</div>
<div class="section" id="resoperator">
<span id="cid-xf-security-details-resoperator"></span><span id="doxid-namespacexf-1-1security-1-1details-1abc86cedbc06fa719ea3ec53bab724269"></span><h2>resOperator<a class="headerlink" href="#resoperator" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/poly1305.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">132</span><span class="o">&gt;</span> <span class="n">resOperator</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">264</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">)</span>
</pre>
<p>The implementation of large bit-width Module Operation, the result is A % 2^130-5. The optimization goal of this function to improve timing.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>A</td>
<td>The input parameter.</td>
</tr>
</tbody>
</table>
<p class="rubric">Returns:</p>
<p>The output result.</p>
</div>
<div class="section" id="poly1305imp">
<span id="cid-xf-security-details-poly1305imp"></span><span id="doxid-namespacexf-1-1security-1-1details-1a71994c0f57c81f9c8ae279199f4dc19d"></span><h2>poly1305Imp<a class="headerlink" href="#poly1305imp" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/poly1305.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">poly1305Imp</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">256</span><span class="o">&gt;&gt;&amp;</span> <span class="n">keyStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">payloadStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">lenPldStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">tagStrm</span>
    <span class="p">)</span>
</pre>
<p>The implementation of poly1305.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>keyStrm</td>
<td>initail key</td>
</tr>
<tr class="row-even"><td>payloadStrm</td>
<td>For a massage, input block stream text, 128 bits per block, less than 128 bits, high padding 0</td>
</tr>
<tr class="row-odd"><td>lenPldStrm</td>
<td>Length of payload in byte.</td>
</tr>
<tr class="row-even"><td>endLenStrm</td>
<td>Flag to signal the end of the length streams.</td>
</tr>
<tr class="row-odd"><td>tagStrm</td>
<td>Return a 16-byte tag to to authenticate the message.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ch">
<span id="cid-xf-security-details-ch"></span><span id="doxid-namespacexf-1-1security-1-1details-1af680f3585034296cc68b7b5fdb54d5f7"></span><h2>Ch<a class="headerlink" href="#ch" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">Ch</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>The implementation of Ch(x,y,z), the sequence of logical functions of SHA-1 where 0 &lt;= t &lt;= 19. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p>The implementation of Ch(x,y,z). The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, y, and z, default value is 32.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The first w-bit input word.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>The second w-bit input word.</td>
</tr>
<tr class="row-even"><td>z</td>
<td>The third w-bit input word.</td>
</tr>
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, y, and z, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The first w-bit input word.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>The second w-bit input word.</td>
</tr>
<tr class="row-even"><td>z</td>
<td>The third w-bit input word.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="parity">
<span id="cid-xf-security-details-parity"></span><span id="doxid-namespacexf-1-1security-1-1details-1ae8fcb30e1e894f23cbad08704d5641eb"></span><h2>Parity<a class="headerlink" href="#parity" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">Parity</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>The implementation of Parity(x,y,z), the sequence of logical functions of SHA-1 where 20 &lt;= t &lt;= 39, and 60 &lt;= t &lt;= 79. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, y, and z, default value is 32.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The first w-bit input word.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>The second w-bit input word.</td>
</tr>
<tr class="row-even"><td>z</td>
<td>The third w-bit input word.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="maj">
<span id="cid-xf-security-details-maj"></span><span id="doxid-namespacexf-1-1security-1-1details-1a969e741d6d91783e2aa91c7b48d0bb52"></span><h2>Maj<a class="headerlink" href="#maj" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">Maj</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">z</span>
    <span class="p">)</span>
</pre>
<p>The implementation of Maj(x,y,z), the sequence of logical functions of SHA-1 where 40 &lt;= t &lt;= 59. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p>The implementation of Maj(x,y,z). The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, y, and z, default value is 32.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The first w-bit input word.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>The second w-bit input word.</td>
</tr>
<tr class="row-even"><td>z</td>
<td>The third w-bit input word.</td>
</tr>
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, y, and z, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The first w-bit input word.</td>
</tr>
<tr class="row-odd"><td>y</td>
<td>The second w-bit input word.</td>
</tr>
<tr class="row-even"><td>z</td>
<td>The third w-bit input word.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="dup-strm">
<span id="cid-xf-security-details-dup-strm-2"></span><span id="doxid-namespacexf-1-1security-1-1details-1a0d462e4e7b61a5e2be4340f425921756"></span><h2>dup_strm<a class="headerlink" href="#dup-strm" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">dup_strm</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">in_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">in_e_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">out1_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">out1_e_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">out2_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">out2_e_strm</span>
    <span class="p">)</span>
</pre>
<p>Duplicate 1 input stream to 2 output streams.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of the streams.</td>
</tr>
<tr class="row-even"><td>in_strm</td>
<td>Input stream to be duplicated.</td>
</tr>
<tr class="row-odd"><td>in_e_strm</td>
<td>End flag of input stream.</td>
</tr>
<tr class="row-even"><td>out1_strm</td>
<td>The first output stream.</td>
</tr>
<tr class="row-odd"><td>out1_e_strm</td>
<td>End flag of the first output stream.</td>
</tr>
<tr class="row-even"><td>out2_strm</td>
<td>The second output stream.</td>
</tr>
<tr class="row-odd"><td>out2_e_strm</td>
<td>End flag of the second output stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="generatemsgschedule">
<span id="cid-xf-security-details-generatemsgschedule-2"></span><span id="doxid-namespacexf-1-1security-1-1details-1a2e984dfcaee9d54662ccb5529d80a43e"></span><h2>generateMsgSchedule<a class="headerlink" href="#generatemsgschedule" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">generateMsgSchedule</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_details_blockType.html#doxid-structxf-1-1security-1-1details-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">w_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate message schedule W (80 words) in stream. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of message schedule W which defined in the standard.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>Message block stream.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>Number of message block stream.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>End flag for number of message block stream.</td>
</tr>
<tr class="row-odd"><td>w_strm</td>
<td>The message schedule in stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sha1digest">
<span id="cid-xf-security-details-sha1digest"></span><span id="doxid-namespacexf-1-1security-1-1details-1a76f31de65da1c8aaa1fdf113381ab3c9"></span><h2>SHA1Digest<a class="headerlink" href="#sha1digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha1.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">SHA1Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">w_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>This function performs the computation of the secure hash algorithm.</p>
<p>The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012. The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of each input message word, default value is 32.</td>
</tr>
<tr class="row-even"><td>w_strm</td>
<td>Message schedule stream.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>Number of message block stream.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>End flag for number of message block stream.</td>
</tr>
<tr class="row-odd"><td>digest_strm</td>
<td>Output digest stream.</td>
</tr>
<tr class="row-even"><td>end_digest_strm</td>
<td>End flag for output digest stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-details-preprocessing-2">
<span id="doxid-namespacexf-1-1security-1-1details-1ac15fc0fcf45caa45011a950816cf21d6"></span><span id="id5"></span><h2>preProcessing<a class="headerlink" href="#cid-xf-security-details-preprocessing-2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="preprocessing-overload-1">
<h3>preProcessing overload (1)<a class="headerlink" href="#preprocessing-overload-1" title="Permalink to this headline">¶</a></h3>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha224_256.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">preProcessing</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">32</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_details_SHA256Block.html#doxid-structxf-1-1security-1-1details-1-1-s-h-a256-block"><span class="std std-ref">SHA256Block</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">uint64_t</span><span class="o">&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate 512bit processing blocks for SHA224/SHA256 (pipeline) with const width. The performance goal of this function is to yield a 512b block per cycle.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>msg_strm</td>
<td>the message being hashed.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>the message length in byte.</td>
</tr>
<tr class="row-odd"><td>end_len_strm</td>
<td>that flag to signal end of input.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>the 512-bit hash block.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>the number of hash block for this message.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>end flag for number of hash block.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="preprocessing-overload-2">
<span id="cid-xf-security-details-preprocessing-3"></span><span id="doxid-namespacexf-1-1security-1-1details-1a50ff8f39a454ffcb6ff9b5f6c3f99e57"></span><h3>preProcessing overload (2)<a class="headerlink" href="#preprocessing-overload-2" title="Permalink to this headline">¶</a></h3>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha224_256.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="kt">void</span> <span class="n">preProcessing</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_details_SHA256Block.html#doxid-structxf-1-1security-1-1details-1-1-s-h-a256-block"><span class="std std-ref">SHA256Block</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">uint64_t</span><span class="o">&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate 512bit processing blocks for SHA224/SHA256 (pipeline) with const width. The performance goal of this function is to yield a 512b block per cycle.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>msg_strm</td>
<td>the message being hashed.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>the message length in byte.</td>
</tr>
<tr class="row-odd"><td>end_len_strm</td>
<td>that flag to signal end of input.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>the 512-bit hash block.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>the number of hash block for this message.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>end flag for number of hash block.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="sha256digest">
<span id="cid-xf-security-details-sha256digest"></span><span id="doxid-namespacexf-1-1security-1-1details-1a5d16559a5979466cbd93e7cdcc4a8da7"></span><h2>sha256Digest<a class="headerlink" href="#sha256digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha224_256.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">int</span> <span class="n">h_width</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">sha256Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">uint64_t</span><span class="o">&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">uint32_t</span><span class="o">&gt;&amp;</span> <span class="n">w_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">h_width</span><span class="o">&gt;&gt;&amp;</span> <span class="n">hash_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_hash_strm</span>
    <span class="p">)</span>
</pre>
<p>Digest message blocks and emit final hash.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>h_width</td>
<td>the hash width(type).</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>number of message block.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>end flag for number of message block.</td>
</tr>
<tr class="row-even"><td>hash_strm</td>
<td>the hash result stream.</td>
</tr>
<tr class="row-odd"><td>end_hash_strm</td>
<td>end flag for hash result.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sha256-top">
<span id="cid-xf-security-details-sha256-top"></span><span id="doxid-namespacexf-1-1security-1-1details-1a0b6eb399d9f28f5cd04d96c79c6de842"></span><h2>sha256_top<a class="headerlink" href="#sha256-top" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha224_256.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">int</span> <span class="n">m_width</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">h_width</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">sha256_top</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">m_width</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">h_width</span><span class="o">&gt;&gt;&amp;</span> <span class="n">hash_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_hash_strm</span>
    <span class="p">)</span>
</pre>
<p>SHA-256/224 implementation top overload for ap_uint input.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>m_width</td>
<td>the input message stream width.</td>
</tr>
<tr class="row-even"><td>h_width</td>
<td>the output hash stream width.</td>
</tr>
<tr class="row-odd"><td>msg_strm</td>
<td>the message being hashed.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>the length message being hashed in byte.</td>
</tr>
<tr class="row-odd"><td>end_len_strm</td>
<td>end flag stream of input, one per message.</td>
</tr>
<tr class="row-even"><td>hash_strm</td>
<td>the result.</td>
</tr>
<tr class="row-odd"><td>end_hash_strm</td>
<td>end falg stream of output, one per hash.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-details-rotl-2">
<span id="doxid-namespacexf-1-1security-1-1details-1a7273b76146abec19a5883c69c2ba00d3"></span><span id="id6"></span><h2>ROTL<a class="headerlink" href="#cid-xf-security-details-rotl-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha3.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">64</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">ROTL</span> <span class="p">(</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span>
    <span class="p">)</span>
</pre>
<p>The implementation of rotate left (circular left shift) operation. The algorithm reference is : “SHA-3 Standard : Permutation-Based Hash and Extendable-Output Functions”.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be rotated.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="keccak-f">
<span id="cid-xf-security-details-keccak-f"></span><span id="doxid-namespacexf-1-1security-1-1details-1a19880785102ffc1fc684abca7cdd1f79"></span><h2>KECCAK_f<a class="headerlink" href="#keccak-f" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha3.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">static</span> <span class="kt">void</span> <span class="n">KECCAK_f</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span> <span class="n">stateArray</span> <span class="p">[</span><span class="mi">25</span><span class="p">])</span>
</pre>
<p>The implementation of KECCAK-f permutation function.</p>
<p>The algorithm reference is : “SHA-3 Standard : Permutation-Based Hash and Extendable-Output Functions”. The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>stateArray</td>
<td>The 5*5*64 state array defined in standard.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sha3digest">
<span id="cid-xf-security-details-sha3digest"></span><span id="doxid-namespacexf-1-1security-1-1details-1abfb4bb749ca38ce965b453a3146c23a4"></span><h2>sha3Digest<a class="headerlink" href="#sha3digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha3.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hashLen</span> <span class="o">=</span> <span class="mi">32</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">sha3Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msgStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msgLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endMsgLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">hashLen</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digestStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endDigestStrm</span>
    <span class="p">)</span>
</pre>
<p>This function performs the computation of SHA-3.</p>
<p>The algorithm reference is : “SHA-3 Standard : Permutation-Based Hash and Extendable-Output Functions”. The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>hashLen</td>
<td>The width of the digest in byte, default value is 32 (SHA3-256).</td>
</tr>
<tr class="row-even"><td>msgStrm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-odd"><td>msgLenStrm</td>
<td>Message length in byte.</td>
</tr>
<tr class="row-even"><td>endMsgLenStrm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-odd"><td>digestStrm</td>
<td>Output digest stream.</td>
</tr>
<tr class="row-even"><td>endDigestStrm</td>
<td>End flag for output digest stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="shakexof">
<span id="cid-xf-security-details-shakexof"></span><span id="doxid-namespacexf-1-1security-1-1details-1ad91823d93ae8c1b060f9e6c9e0ef21d8"></span><h2>shakeXOF<a class="headerlink" href="#shakexof" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha3.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hashLen</span> <span class="o">=</span> <span class="mi">16</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">shakeXOF</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msgStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msgLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endMsgLenStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">8</span><span class="o">*</span><span class="n">hashLen</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digestStrm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">endDigestStrm</span>
    <span class="p">)</span>
</pre>
<p>This function performs the computation of SHAKE.</p>
<p>The algorithm reference is : “SHA-3 Standard : Permutation-Based Hash and Extendable-Output Functions”. The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>hashLen</td>
<td>The width of the digest in byte, default value is 16 (SHAKE-128).</td>
</tr>
<tr class="row-even"><td>msgStrm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-odd"><td>msgLenStrm</td>
<td>Message length in byte.</td>
</tr>
<tr class="row-even"><td>endMsgLenStrm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-odd"><td>digestStrm</td>
<td>Output digest stream.</td>
</tr>
<tr class="row-even"><td>endDigestStrm</td>
<td>End flag for output digest stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-details-preprocessing-4">
<span id="doxid-namespacexf-1-1security-1-1details-1af17bff1339abe5a302bd1adbcec2789e"></span><span id="id7"></span><h2>preProcessing<a class="headerlink" href="#cid-xf-security-details-preprocessing-4" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">preProcessing</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_details_blockType.html#doxid-structxf-1-1security-1-1details-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate 1024-bit processing blocks by padding and appending (pipeline).</p>
<p>The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012. The optimization goal of this function is to yield a 1024-bit block per cycle.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of each input message word, default value is 64.</td>
</tr>
<tr class="row-even"><td>msg_strm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-odd"><td>len_strm</td>
<td>The message length in byte.</td>
</tr>
<tr class="row-even"><td>end_len_strm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-odd"><td>blk_strm</td>
<td>The 1024-bit hash block.</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>The number of hash block for this message.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>End flag for number of hash block.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="shr">
<span id="cid-xf-security-details-shr"></span><span id="doxid-namespacexf-1-1security-1-1details-1aefd2a0c9c01be79d85e2f6fad38db4c7"></span><h2>SHR<a class="headerlink" href="#shr" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">SHR</span> <span class="p">(</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span>
    <span class="p">)</span>
</pre>
<p>The implementation of right shift operation. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be shifted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-details-rotr-2">
<span id="doxid-namespacexf-1-1security-1-1details-1a1ab9416cc0d63e84a70e4030f328a9ff"></span><span id="id8"></span><h2>ROTR<a class="headerlink" href="#cid-xf-security-details-rotr-2" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">ROTR</span> <span class="p">(</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span>
    <span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span>
    <span class="p">)</span>
</pre>
<p>The implementation of rotate right (circular right shift) operation. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>n</td>
<td>Number of bits for input x to be shifted.</td>
</tr>
<tr class="row-odd"><td>x</td>
<td>Word to be rotated.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bsig0">
<span id="cid-xf-security-details-bsig0"></span><span id="doxid-namespacexf-1-1security-1-1details-1ab28659aeaee00ecba95297be65f7ccc9"></span><h2>BSIG0<a class="headerlink" href="#bsig0" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">BSIG0</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">)</span>
</pre>
<p>The implementation of upper-case letter sigma 0. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="bsig1">
<span id="cid-xf-security-details-bsig1"></span><span id="doxid-namespacexf-1-1security-1-1details-1af75e535f0f90def371f9154e885cd10c"></span><h2>BSIG1<a class="headerlink" href="#bsig1" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">BSIG1</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">)</span>
</pre>
<p>The implementation of upper-case letter sigma 1. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ssig0">
<span id="cid-xf-security-details-ssig0"></span><span id="doxid-namespacexf-1-1security-1-1details-1a5ba691c73c7faa20521a395fc30e8fc1"></span><h2>SSIG0<a class="headerlink" href="#ssig0" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">SSIG0</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">)</span>
</pre>
<p>The implementation of lower-case letter sigma 0. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ssig1">
<span id="cid-xf-security-details-ssig1"></span><span id="doxid-namespacexf-1-1security-1-1details-1a8b8749a6355403e195b80e3ce8152ccf"></span><h2>SSIG1<a class="headerlink" href="#ssig1" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">SSIG1</span> <span class="p">(</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">)</span>
</pre>
<p>The implementation of lower-case letter sigma 1. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of input x, default value is 64.</td>
</tr>
<tr class="row-even"><td>x</td>
<td>The operand.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="cid-xf-security-details-generatemsgschedule-3">
<span id="doxid-namespacexf-1-1security-1-1details-1aa5fc18d5c7c89a0fe0f9be40bd602dcc"></span><span id="id9"></span><h2>generateMsgSchedule<a class="headerlink" href="#cid-xf-security-details-generatemsgschedule-3" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">generateMsgSchedule</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><a class="reference internal" href="struct_xf_security_details_blockType.html#doxid-structxf-1-1security-1-1details-1-1block-type"><span class="std std-ref">blockType</span></a><span></span><span class="o">&gt;&amp;</span> <span class="n">blk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">w_strm</span>
    <span class="p">)</span>
</pre>
<p>Generate message schedule W (80 words) in stream. The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of message schedule W which defined in the standard, default value is 64.</td>
</tr>
<tr class="row-even"><td>blk_strm</td>
<td>Message block stream.</td>
</tr>
<tr class="row-odd"><td>nblk_strm</td>
<td>Number of message block stream.</td>
</tr>
<tr class="row-even"><td>end_nblk_strm</td>
<td>End flag for number of message block stream.</td>
</tr>
<tr class="row-odd"><td>w_strm</td>
<td>The message schedule in stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sha512digest">
<span id="cid-xf-security-details-sha512digest"></span><span id="doxid-namespacexf-1-1security-1-1details-1a4b04850498c5dc7230eb42c82446551e"></span><h2>SHA512Digest<a class="headerlink" href="#sha512digest" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hash_width</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">SHA512Digest</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">w_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_nblk_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">hash_width</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>This function performs the computation of SHA-512.</p>
<p>The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012. The implementation is modified for better performance.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of each input message word, default value is 64.</td>
</tr>
<tr class="row-even"><td>hash_width</td>
<td>The bit width of hash width, which depends on specific algorithm.</td>
</tr>
<tr class="row-odd"><td>w_strm</td>
<td>Message schedule stream.</td>
</tr>
<tr class="row-even"><td>nblk_strm</td>
<td>Number of message block stream.</td>
</tr>
<tr class="row-odd"><td>end_nblk_strm</td>
<td>End flag for number of message block stream.</td>
</tr>
<tr class="row-even"><td>digest_strm</td>
<td>Output digest stream.</td>
</tr>
<tr class="row-odd"><td>end_digest_strm</td>
<td>End flag for output digest stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sha512top">
<span id="cid-xf-security-details-sha512top"></span><span id="doxid-namespacexf-1-1security-1-1details-1ae25a12dc808b51fc3615ac718eb1c487"></span><h2>sha512Top<a class="headerlink" href="#sha512top" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/sha512_t.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">w</span><span class="p">,</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hash_width</span>
    <span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">sha512Top</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">w</span><span class="o">&gt;&gt;&amp;</span> <span class="n">msg_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">hash_width</span><span class="o">&gt;&gt;&amp;</span> <span class="n">digest_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">end_digest_strm</span>
    <span class="p">)</span>
</pre>
<p>Top of SHA-512.</p>
<p>The algorithm reference is : “Secure Hash Standard”, which published by NIST in February 2012. The implementation dataflows the pre-processing part and message digest part.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>w</td>
<td>The bit width of each input message word, default value is 64.</td>
</tr>
<tr class="row-even"><td>hash_width</td>
<td>The bit width of hash width, which depends on specific algorithm.</td>
</tr>
<tr class="row-odd"><td>msg_strm</td>
<td>The message being hashed.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>The message length in byte.</td>
</tr>
<tr class="row-odd"><td>end_len_strm</td>
<td>The flag to signal end of input message stream.</td>
</tr>
<tr class="row-even"><td>digest_strm</td>
<td>Output digest stream.</td>
</tr>
<tr class="row-odd"><td>end_digest_strm</td>
<td>End flag for output digest stream.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesxtsencrypt">
<span id="cid-xf-security-details-aesxtsencrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1ada00480a7c97b1592a179debb327e2cb"></span><h2>aesXtsEncrypt<a class="headerlink" href="#aesxtsencrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/xts.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesXtsEncrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e_strm</span>
    <span class="p">)</span>
</pre>
<p>aesXtsEncrypt is XTS encryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “IEEE Standard for Cryptographic Protection of
Data on Block-Oriented Storage Devices” The implementation is optimized for better performance in FPGA.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>plaintext_strm</td>
<td>Input block stream text to be encrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_e_strm</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>Total length of plaintext in bit, 64 bits.</td>
</tr>
<tr class="row-odd"><td>cipherkey_strm</td>
<td>Input two cipher key used in encryption, x bits for AES-x.</td>
</tr>
<tr class="row-even"><td>initialization_vector_strm</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_strm</td>
<td>Output encrypted block stream text, 128 bits.</td>
</tr>
<tr class="row-even"><td>ciphertext_e_strm</td>
<td>End flag of stream ciphertext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aesxtsdecrypt">
<span id="cid-xf-security-details-aesxtsdecrypt"></span><span id="doxid-namespacexf-1-1security-1-1details-1a945feb3736d61e840071433b6cb1829f"></span><h2>aesXtsDecrypt<a class="headerlink" href="#aesxtsdecrypt" title="Permalink to this headline">¶</a></h2>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_security/xts.hpp&quot;</span>
</pre>
<pre class="highlight title-code-block literal-block">
<span></span><span class="k">template</span> <span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_keyWidth</span> <span class="o">=</span> <span class="mi">256</span><span class="o">&gt;</span>
<span class="kt">void</span> <span class="n">aesXtsDecrypt</span> <span class="p">(</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">ciphertext_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">ciphertext_e_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;&gt;&amp;</span> <span class="n">len_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="n">_keyWidth</span><span class="o">&gt;&gt;&amp;</span> <span class="n">cipherkey_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">initialization_vector_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="n">ap_uint</span> <span class="o">&lt;</span><span class="mi">128</span><span class="o">&gt;&gt;&amp;</span> <span class="n">plaintext_strm</span><span class="p">,</span>
    <span class="n">hls</span><span class="o">::</span><span class="n">stream</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="o">&gt;&amp;</span> <span class="n">plaintext_e_strm</span>
    <span class="p">)</span>
</pre>
<p>aesXtsDecrypt is XTS decryption mode with AES single block cipher.</p>
<p>The algorithm reference is : “IEEE Standard for Cryptographic Protection of
Data on Block-Oriented Storage Devices” The implementation is optimized for better performance in FPGA.</p>
<p class="rubric">Parameters:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>_keyWidth</td>
<td>The bit-width of the cipher key, which is 128, 192, or 256.</td>
</tr>
<tr class="row-even"><td>ciphertext_strm</td>
<td>Input block stream text to be decrypted, each block is 128 bits.</td>
</tr>
<tr class="row-odd"><td>ciphertext_e_strm</td>
<td>End flag of block stream ciphertext, 1 bit.</td>
</tr>
<tr class="row-even"><td>len_strm</td>
<td>Total length of plaintext in bit, 64 bits.</td>
</tr>
<tr class="row-odd"><td>cipherkey_strm</td>
<td>Input two cipher key used in decryption, x bits for AES-x.</td>
</tr>
<tr class="row-even"><td>initialization_vector_strm</td>
<td>Initialization vector for the fisrt iteration of AES encrypition, 128 bits.</td>
</tr>
<tr class="row-odd"><td>plaintext_strm</td>
<td>Output decrypted block stream text, each block is 128 bits.</td>
</tr>
<tr class="row-even"><td>plaintext_e_strm</td>
<td>End flag of block stream plaintext, 1 bit.</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Xilinx Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>