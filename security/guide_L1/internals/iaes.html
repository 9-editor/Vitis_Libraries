

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="Vitis, library, Database, Quantitative Finance, Vision, Data Compression, Security, Solver, BLAS, Hardware, xfOpenCV, xfdatabase, xffintech, xfcompression, xfsecurity, xfsolver, xfblas, xfhardware"/>
<meta name="description" content="Vitis software development platform includes an extensive set of open-source, performance-optimized libraries that offer out-of-the-box acceleration with minimal to zero-code changes to your existing applications, without the need to reimplement your algorithms from scratch to harness the benefits of Xilinx adaptive compute."/>
<meta name="xlnxdocumentclass" content="Document"> 
<meta name="xlnxdocumenttypes" content="Tutorials"> 
<!-- Header information provided by Emily-->
    <meta name="Language" content="en">
    <meta name="Location" content="us">
    <link rel="icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
  
  <title>AES Decryption Algorithms &mdash; Vitis Security Library v2019.2 documentation</title>
  
<!-- Header information provided by Emily-->
    <meta name="apple-itunes-app" content="app-id=1063287962">
    <meta name="google-play-app" content="app-id=com.marketing.xilinxgo">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="https://kit.fontawesome.com/d3dd8c60ed.js"></script>
    
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/header-footer.min.css" type="text/css">
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all.min.css" type="text/css">
    
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/header-footer.min.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css">
  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="The MD4/MD5 Message-Digest Algorithms" href="md4_5.html" />
    <link rel="prev" title="HMAC Algorithms" href="hmac.html" /> 
</head>

<body class="wy-body-for-nav">
<div class="xilinx-bs3">
    <noindex>
        <header data-component="header">
            <nav class="navbar navbar-default">
                <div class="container main-nav">
                    <div class="row">
                        <div class="col-xs-5 col-sm-2 logo-column">
                            <div class="logo">
                                <a href="https://www.xilinx.com/">
                                    <img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc" />
                                </a>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 navbar-column">
                            <div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
                                <ul class="nav navbar-nav nav-justified">
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://developer.xilinx.com/">
                                            Developers
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://www.xilinx.com/support.html">
                                            Support
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://forums.xilinx.com/">
                                            Forums
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="mini-nav col-sm-2">
                            <button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
        </header>
    </noindex>
</div>
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis Security Library
          

          
          </a>

          
            
            
              <div class="version">
                2019.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#trademark-notice">Trademark Notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release Note</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../hw_guide.html">L1 Module User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../internals.html">Design Internals</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="aes.html">AES Encryption Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="blake2b.html">BLAKE2 Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="cbc.html">CBC Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="ccm.html">CCM Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfb.html">CFB Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="chacha20.html">Chacha20 Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="ctr.html">CTR Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="des.html">DES and 3DES Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="ecb.html">ECB Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="gcm.html">GCM Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmac.html">GMAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="hmac.html">HMAC Algorithms</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">AES Decryption Algorithms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#original-implementation">Original Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimized-implementation-on-fpga">Optimized Implementation on FPGA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aes-128-decryption-performance-device-u250">AES-128 Decryption Performance (Device:U250)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aes-192-decryption-performance-device-u250">AES-192 Decryption Performance (Device:U250)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aes-256-decryption-performance-device-u250">AES-256 Decryption Performance (Device:U250)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="md4_5.html">The MD4/MD5 Message-Digest Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="ofb.html">OFB Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="poly1305.html">Poly1305 Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="rc4.html">RC4 Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="rsa.html">RSA Cryptography</a></li>
<li class="toctree-l3"><a class="reference internal" href="sha1.html">SHA-1 Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="sha2.html">SHA-2 Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="sha3.html">SHA-3 Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="xts.html">XTS mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../hw_api.html">API Functions of <code class="docutils literal notranslate"><span class="pre">xf::security</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Benchmark Result</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../benchmark/result.html">Benchmark Result</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vitis Security Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../hw_guide.html">L1 Module User Guide</a> &raquo;</li>
        
          <li><a href="../internals.html">Design Internals</a> &raquo;</li>
        
      <li>AES Decryption Algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aes-decryption-algorithms">
<h1>AES Decryption Algorithms<a class="headerlink" href="#aes-decryption-algorithms" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>AES-128/192/256 decryption algorithms processes cipher data blocks of 128 bits,
generates plain data blocks of 128 bits using same cipher keys of 128/192/256 bits in data encryption.
Basic unit of AES algorithms operation is a two dimensional array of 16 bytes called states.
Its mapping relation is as illustrated in the figure below.</p>
<a class="reference internal image-reference" href="../../_images/state_of_bytes.png"><img alt="state of bytes" class="align-center" src="../../_images/state_of_bytes.png" style="width: 100%;" /></a>
<div class="section" id="original-implementation">
<h2>Original Implementation<a class="headerlink" href="#original-implementation" title="Permalink to this headline">¶</a></h2>
<p>Similarly, AES decryption consists of 5 part: KeyExpansion, Inverse SubBytes, Inverse ShiftRows, Inverse MixColumns and AddRoundKey.</p>
<p>KeyExpansion also generates 11/13/15 round keys from input cipher key and they maps to 2-D array as states do.</p>
<p>For one input cipher block, AES-128/192/256 decryption performs 10/12/14 round of processing with the former round keys from behind, each at a time.
Thus, input cipher data blocks will operate XOR with the last roundkey. After that, every round sequentially goes through AddRoundKey, Inverse MixColumns,
Inverse ShiftRows and Inverse SubBytes. Meanwhile, Inverse MixColumns will be bypassed at the first round.</p>
<a class="reference internal image-reference" href="../../_images/original_decryption_flow.png"><img alt="original flow of AES-256 decryption" class="align-center" src="../../_images/original_decryption_flow.png" style="width: 100%;" /></a>
<p>Like AES encryption, Inverse SubBytes are transformed into looking up table which is called inverse S-box and is different with that in encryption.
Details can be found in the chapter of AES encryption.</p>
<p>During Inverse ShiftRows, right circular shift are operated based on each row number in 2-D state array.</p>
<p>In Inverse MixColumns step, matrix multiplication is involved to transform each column of states.
Transform matrix is fixed and calculation treats each bytes as polynomials with coefficients in GF(2^8), modulo x^4 + 1.</p>
<a class="reference internal image-reference" href="../../_images/inverse_mixcolumns.png"><img alt="inverse mixcolumns operation" class="align-center" src="../../_images/inverse_mixcolumns.png" style="width: 100%;" /></a>
<p>In AddRoundKey step, states in each column operate XOR with roundkey of this round.</p>
</div>
<div class="section" id="optimized-implementation-on-fpga">
<h2>Optimized Implementation on FPGA<a class="headerlink" href="#optimized-implementation-on-fpga" title="Permalink to this headline">¶</a></h2>
<p>Like in AES encryption, we separate key expansion away from decryption. We must call updateKey() before use a new cipher key to decrypt message.</p>
<p>Based on similar consideration in AES encryption implementation, we also can merge inverse SubBytes and Inverse MixColumns into
one look-up table as long as operation flow is re-ordered appropriately.
Therefore, we adopt that Inverse MixColumns and AddRoundKey are exchanged with each other in one operation round.
However, generated key at KeyExpansion stage must be followed by one extra Inverse MixColumns operation for correct decryption.
It’s worth to do because of hardware overhead of matrix multiplication in GF(2^8) will be reduced obviously. Furthermore, this addition operation
will be executed only once for most case which plenty of blocks are decrypted with sharing the same cipher key. The optimzed flow is shown as below.</p>
<a class="reference internal image-reference" href="../../_images/new_decrypt_flow.png"><img alt="optimzied decryption flow" class="align-center" src="../../_images/new_decrypt_flow.png" style="width: 100%;" /></a>
<p>Since each round of process needs one round key in reverse order, and that indicateds the dependency between KeyExpansion and decryption process.
KeyExpansion is separated from the whole decryption loop.</p>
<p>In addition, in order to eliminate unnecessary inverse SubBytes operation in the common loop-up table within decryption process, one same SubBytes process should be operated on round keys before they come into Inverse MixColumns step. For the last round in one block decryption, Inverse MixColumns will be skipped.</p>
</div>
<div class="section" id="aes-128-decryption-performance-device-u250">
<h2>AES-128 Decryption Performance (Device:U250)<a class="headerlink" href="#aes-128-decryption-performance-device-u250" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="9%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">II</th>
<th class="head">CLB</th>
<th class="head">LUT</th>
<th class="head">FF</th>
<th class="head">DSP</th>
<th class="head">BRAM</th>
<th class="head">SRL</th>
<th class="head">URAM</th>
<th class="head">CP(ns)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>5305</td>
<td>27673</td>
<td>11074</td>
<td>0</td>
<td>10</td>
<td>710</td>
<td>0</td>
<td>3.076</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aes-192-decryption-performance-device-u250">
<h2>AES-192 Decryption Performance (Device:U250)<a class="headerlink" href="#aes-192-decryption-performance-device-u250" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="9%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">II</th>
<th class="head">CLB</th>
<th class="head">LUT</th>
<th class="head">FF</th>
<th class="head">DSP</th>
<th class="head">BRAM</th>
<th class="head">SRL</th>
<th class="head">URAM</th>
<th class="head">CP(ns)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>6409</td>
<td>33433</td>
<td>13296</td>
<td>0</td>
<td>14</td>
<td>898</td>
<td>0</td>
<td>3.032</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="aes-256-decryption-performance-device-u250">
<h2>AES-256 Decryption Performance (Device:U250)<a class="headerlink" href="#aes-256-decryption-performance-device-u250" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="9%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="14%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">II</th>
<th class="head">CLB</th>
<th class="head">LUT</th>
<th class="head">FF</th>
<th class="head">DSP</th>
<th class="head">BRAM</th>
<th class="head">SRL</th>
<th class="head">URAM</th>
<th class="head">CP(ns)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>7442</td>
<td>38636</td>
<td>14985</td>
<td>0</td>
<td>10</td>
<td>1153</td>
<td>0</td>
<td>3.016</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="md4_5.html" class="btn btn-neutral float-right" title="The MD4/MD5 Message-Digest Algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hmac.html" class="btn btn-neutral float-left" title="HMAC Algorithms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p>
        
        &copy; Copyright 2019, Xilinx

    </p>
  </div>
<!--
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 
-->
</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>