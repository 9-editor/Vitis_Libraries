

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="Vitis, Security, Library, RSA, Cryptography" name="keywords" />
<meta content="RSA is a public-key cryptosystem. Its encryption key is public and different from decryption key." name="description" />
<meta content="Document" name="xlnxdocumentclass" />
<meta content="Tutorials" name="xlnxdocumenttype" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Header information provided by Emily-->
    <meta name="Language" content="en">
    <meta name="Location" content="us">
    <link rel="icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
  
  <title>RSA Cryptography &mdash; Vitis Security Library v2019.2 documentation</title>
  
<!-- Header information provided by Emily-->
    <meta name="apple-itunes-app" content="app-id=1063287962">
    <meta name="google-play-app" content="app-id=com.marketing.xilinxgo">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="https://kit.fontawesome.com/d3dd8c60ed.js"></script>
    
   
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.css" type="text/css" />
    <link rel="stylesheet" href="https://www.xilinx.com/xx/rebrand/r40/header-footer.min.css" type="text/css" />
    
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery.min.js"><!----></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.js"><!----></script>
    <script type="text/javascript" src="https://www.xilinx.com/xx/rebrand/r40/header-footer.min.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css">
  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="SHA-1 Algorithm" href="sha1.html" />
    <link rel="prev" title="RC4 Algorithms" href="rc4.html" /> 
</head>

<body class="wy-body-for-nav">
<div class="xilinx-bs3">
    <noindex>
        <header data-component="header">
            <nav class="navbar navbar-default">
                <div class="container main-nav">
                    <div class="row">
                        <div class="col-xs-5 col-sm-2 logo-column">
                            <div class="logo">
                                <a href="https://www.xilinx.com/">
                                    <img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc" />
                                </a>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 navbar-column">
                            <div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
                                <ul class="nav navbar-nav nav-justified">
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://developer.xilinx.com/">
                                            Developers
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://www.xilinx.com/support.html">
                                            Support
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://forums.xilinx.com/">
                                            Forums
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="mini-nav col-sm-2">
                            <button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
        </header>
    </noindex>
</div>
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis Security Library
          

          
          </a>

          
            
            
              <div class="version">
                2019.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#trademark-notice">Trademark Notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release Note</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../hw_guide.html">L1 Module User Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../internals.html">Design Internals</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="aes.html">AES Encryption Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="blake2b.html">BLAKE2 Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="cbc.html">CBC Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="ccm.html">CCM Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="cfb.html">CFB Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="chacha20.html">Chacha20 Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="ctr.html">CTR Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="des.html">DES and 3DES Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="ecb.html">ECB Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="gcm.html">GCM Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="gmac.html">GMAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="hmac.html">HMAC Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="iaes.html">AES Decryption Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="md4_5.html">The MD4/MD5 Message-Digest Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="ofb.html">OFB Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="poly1305.html">Poly1305 Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="rc4.html">RC4 Algorithms</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">RSA Cryptography</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#implementation">Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimized-implementation-on-fpga">Optimized Implementation on FPGA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reference">Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rsa-performance-device-u250">RSA Performance(Device: U250)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sha1.html">SHA-1 Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="sha2.html">SHA-2 Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="sha3.html">SHA-3 Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="xts.html">XTS mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../hw_api.html">API Functions of <code class="docutils literal notranslate"><span class="pre">xf::security</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Benchmark Result</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../benchmark/result.html">Benchmark Result</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vitis Security Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../hw_guide.html">L1 Module User Guide</a> &raquo;</li>
        
          <li><a href="../internals.html">Design Internals</a> &raquo;</li>
        
      <li>RSA Cryptography</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rsa-cryptography">
<h1>RSA Cryptography<a class="headerlink" href="#rsa-cryptography" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>RSA is a public-key cryptosystem. Its encryption key is public and different from decryption key.
RSA cryptosystem includes key generation, key distribution, encryption/decryption and padding schemes. In this release we provide the encryption/decryption part.</p>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>RSA key pair has 3 part: modulus <span class="math notranslate nohighlight">\(n\)</span> , encryption key exponent <span class="math notranslate nohighlight">\(e\)</span>, decryption key exponent <span class="math notranslate nohighlight">\(d\)</span>.
Plain text is an unsigned integer <span class="math notranslate nohighlight">\(m\)</span>, not larger than modulus and Cipher text is also an unsigned integer <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p>In Encryption we have:</p>
<div class="math notranslate nohighlight">
\[c = m^{e} \mod{n}\]</div>
<p>In Decryption we have:</p>
<div class="math notranslate nohighlight">
\[m = c^{d} \mod{n}\]</div>
</div>
<div class="section" id="optimized-implementation-on-fpga">
<h2>Optimized Implementation on FPGA<a class="headerlink" href="#optimized-implementation-on-fpga" title="Permalink to this headline">¶</a></h2>
<p>We seperate encryption into two part: updateKey and process. Each time we got an message with a new RSA key, we have to call updateKey before get into encryption/decryption. If we process messages with the same key continuously, updateKey only need be call once at the beginning.</p>
<p>RSA encryption and decryption are basically the same calculation: big integer exponent modulus.
We first transform message to its Montgomery representation, then perform Montgomery modular exponentiation.
At last we tranform it back to normal expression to get final result.
By such implementation, we avoid all big integer division to get modulus, except for the one during transformation to Montegomery representation.</p>
<p>In updateKey, we calculate modular multiplicative inverse using extend Eculid Algorithms. Also we calculate the position of first non-zero big of exponent.Both calculation is to prepare for later process and save unnecessary calculations.</p>
<p>In process, we need to do a lot of big integer multiplication which will cost a lot of DSPs.
Since All these multiplication are inter dependent, there’re no way to parallelize.
So most optimization focused on pipeline DSP inside multiplications.
We treat big integer, like a 2048 bits integer, as a BlockNum digits integer in radix BlockWidth.
We choose BlockNum and BlockWidth so that <span class="math notranslate nohighlight">\(2048 = BlockNum * BlockWidth\)</span>.
A BlockWidth x BlockWdith multiplication is a basic operation, and a 2048 bits x 2048 bits multiplication could be done by BlockNum x BlockNum basic operations.
We utilize DSPs in a way that they could finish these basic operations independently.
In such way, we utilize fewer DSP and have better timing.</p>
<a class="reference internal image-reference" href="../../_images/rsa_1.png"><img alt="Illustration of big integer multiplication." class="align-center" src="../../_images/rsa_1.png" style="width: 30%;" /></a>
</div>
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h2>
<p>Peter Montgomery. “Modular Multiplication Without Trial Division”, Mathematics of Computation, vol. 44 no. 170, pp. 519–521, April 1985.</p>
<p>Knuth, Donald. The Art of Computer Programming. Addison-Wesley. Volume 2, Chapter 4.</p>
</div>
<div class="section" id="rsa-performance-device-u250">
<h2>RSA Performance(Device: U250)<a class="headerlink" href="#rsa-performance-device-u250" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="14%" />
<col width="14%" />
<col width="10%" />
<col width="12%" />
<col width="10%" />
<col width="12%" />
<col width="16%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">CLB</th>
<th class="head">LUT</th>
<th class="head">FF</th>
<th class="head">DSP</th>
<th class="head">BRAM</th>
<th class="head">SRL</th>
<th class="head">URAM</th>
<th class="head">CP(ns)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>3428</td>
<td>28668</td>
<td>94455</td>
<td>128</td>
<td>0</td>
<td>942</td>
<td>0</td>
<td>3.160</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sha1.html" class="btn btn-neutral float-right" title="SHA-1 Algorithm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="rc4.html" class="btn btn-neutral float-left" title="RC4 Algorithms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p>
        
        &copy; Copyright 2019, Xilinx

    </p>
  </div>
<!--
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 
-->
</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>