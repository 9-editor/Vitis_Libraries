

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="Vitis, library, Database, Quantitative Finance, Vision, Data Compression, Security, Solver, BLAS, Hardware, xfOpenCV, xfdatabase, xffintech, xfcompression, xfsecurity, xfsolver, xfblas, xfhardware"/>
<meta name="description" content="Vitis software development platform includes an extensive set of open-source, performance-optimized libraries that offer out-of-the-box acceleration with minimal to zero-code changes to your existing applications, without the need to reimplement your algorithms from scratch to harness the benefits of Xilinx adaptive compute."/>
<meta name="xlnxdocumentclass" content="Document"> 
<meta name="xlnxdocumenttypes" content="Tutorials"> 
<!-- Header information provided by Emily-->
    <meta name="Language" content="en">
    <meta name="Location" content="us">
    <link rel="icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
  
  <title>Demo &mdash; Vitis Data Compression Library v2019.2 documentation</title>
  
<!-- Header information provided by Emily-->
    <meta name="apple-itunes-app" content="app-id=1063287962">
    <meta name="google-play-app" content="app-id=com.marketing.xilinxgo">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="https://kit.fontawesome.com/d3dd8c60ed.js"></script>
    
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/header-footer.min.css" type="text/css">
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all.min.css" type="text/css">
    
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/header-footer.min.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css">
  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Benchmark Results" href="../results.html" />
    <link rel="prev" title="class xf::compression::xfZlib" href="../../doxygen/L3/rst/class_xf_compression_xfZlib.html" /> 
</head>

<body class="wy-body-for-nav">
<div class="xilinx-bs3">
    <noindex>
        <header data-component="header">
            <nav class="navbar navbar-default">
                <div class="container main-nav">
                    <div class="row">
                        <div class="col-xs-5 col-sm-2 logo-column">
                            <div class="logo">
                                <a href="https://www.xilinx.com/">
                                    <img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc" />
                                </a>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 navbar-column">
                            <div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
                                <ul class="nav navbar-nav nav-justified">
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://developer.xilinx.com/">
                                            Developers
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://www.xilinx.com/support.html">
                                            Support
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://forums.xilinx.com/">
                                            Forums
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="mini-nav col-sm-2">
                            <button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
        </header>
    </noindex>
</div>
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis Data Compression Library
          

          
          </a>

          
            
            
              <div class="version">
                2019.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html#trademark-notice">Trademark Notice</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usecase.html">Typical Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L1/L1.html">L1 Module User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../L2/L2.html">L2 Kernel User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="L3.html">L3 Overlay User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_reference.html">Overlay API Reference</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Demo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#environment-setup">Environment Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#build-instructions">Build Instructions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#zlib-application">Zlib Application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#executable-usage">Executable Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#software-api-usage">Software API Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lz4-application">LZ4 Application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Executable Usage</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Benchmark Results</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../results.html">Benchmark Results</a></li>
</ul>

            
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../_sources/source/L3/demo.rst.txt"
						rel="nofollow">Show Source</a></li>
					<li class="toctree-l1"><a href="https://github.com/Xilinx/xf_compression/blob/master/docs/source/overview.rst/source/L3/demo.rst"
						   rel="nofollow">View on GitHub</a></li>						
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vitis Data Compression Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="L3.html">L3 Overlay User Guide</a> &raquo;</li>
        
      <li>Demo</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/source/L3/demo.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="demo">
<h1>Demo<a class="headerlink" href="#demo" title="Permalink to this headline">¶</a></h1>
<p>This section presents integration of various modules from L1, L2 levels in
combination with software APIs to derive end application that can be directly
deployed or creation of shared library that can be integrated with external
applications.</p>
<p>Demo examples for Zlib and Lz4 applications are present in <strong>L3/demos/</strong>
directory.</p>
<div class="section" id="environment-setup">
<h2>Environment Setup<a class="headerlink" href="#environment-setup" title="Permalink to this headline">¶</a></h2>
<p>Instructions below setup Vitis environment for builid the application. These
instructions are applicable for all the demos under this category.</p>
<pre class="highlight literal-block"><span></span><span class="nv">$source</span> &lt;Vitis_Installation_Path&gt;/installs/lin64/Vitis/2019.2/settings64.csh
<span class="nv">$source</span> &lt;Vitis_Installation_Path&gt;/xbb/xrt/packages/setenv.sh</pre>
<div class="section" id="build-instructions">
<h3>Build Instructions<a class="headerlink" href="#build-instructions" title="Permalink to this headline">¶</a></h3>
<p>To compile and test run this application execute the following commands:</p>
<pre class="highlight literal-block"><span></span>$ make run <span class="nv">TARGET</span><span class="o">=</span>sw_emu</pre>
<p>Variable <code class="docutils literal notranslate"><span class="pre">TARGET</span></code> can take the following values:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>sw_emu</strong>    : software emulation</p></li>
<li><p><strong>hw_emu</strong>    : hardware emulation</p></li>
<li><p><strong>hw</strong>        : run on actual hardware</p></li>
</ul>
</div></blockquote>
<p>Build instructions are common for all the application but generated executable
differ.</p>
</div>
</div>
<div class="section" id="zlib-application">
<h2>Zlib Application<a class="headerlink" href="#zlib-application" title="Permalink to this headline">¶</a></h2>
<p>This section presents brief introduction about Zlib application and step by step
guidelines to build and deployment.</p>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>ZLIB is an Open Source data compression library [Reference] which provides
high compression ratio compared to Limpel Ziev based data compression algorithms
(Byte Compression). It applies two levels of compression,</p>
<ul class="simple">
<li><p>Byte Level (Limpel Ziev – LZ Based Compression Scheme)</p></li>
<li><p>Bit Level (Huffman – Entropy)</p></li>
</ul>
<p>Due to its high compression ratio it takes higher precedence over LZ based
compression schemes. Traditionally the CPU based solutions are limited to MB/s
speed but there is a high demand for accelerated ZLIB which provides throughput
in terms of GB/s.</p>
<p>This demo is aimed at showcasing Alveo U200 acceleration of ZLIB for both
compression and decompression.</p>
</div>
<div class="section" id="executable-usage">
<h3>Executable Usage<a class="headerlink" href="#executable-usage" title="Permalink to this headline">¶</a></h3>
<p>This application is present under <code class="docutils literal notranslate"><span class="pre">L3/demos/zlib_app/</span></code> directory. Follow build instructions to generate executable and binary.</p>
<p>The host executable generated is named as “<strong>xil_zlib</strong>” and it is generated in <code class="docutils literal notranslate"><span class="pre">./build</span></code> directory.</p>
<p>Following is the usage of the executable:</p>
<ol class="arabic">
<li><p>To execute single file for compression                 : <code class="docutils literal notranslate"><span class="pre">./build/xil_zlib</span> <span class="pre">-sx</span> <span class="pre">./build/xclbin_&lt;dsa_name&gt;_&lt;TARGET</span> <span class="pre">mode&gt;/compress_decompress.xclbin</span> <span class="pre">-c</span> <span class="pre">&lt;input</span> <span class="pre">file_name&gt;</span></code></p></li>
<li><p>To execute single file for decompression           : <code class="docutils literal notranslate"><span class="pre">./build/xil_zlib</span> <span class="pre">-sx</span> <span class="pre">./build/xclbin_&lt;dsa_name&gt;_&lt;TARGET</span> <span class="pre">mode&gt;/compress_decompress.xclbin</span> <span class="pre">-d</span> <span class="pre">&lt;compressed</span> <span class="pre">file_name&gt;</span></code></p></li>
<li><p>To validate single file (compress &amp; decompress)    : <code class="docutils literal notranslate"><span class="pre">./build/xil_zlib</span> <span class="pre">-sx</span> <span class="pre">./build/xclbin_&lt;dsa_name&gt;_&lt;TARGET</span> <span class="pre">mode&gt;/compress_decompress.xclbin</span> <span class="pre">-v</span> <span class="pre">&lt;input</span> <span class="pre">file_name&gt;</span></code></p></li>
<li><p>To validate multiple files (compress &amp; decompress) : <code class="docutils literal notranslate"><span class="pre">./build/xil_zlib</span> <span class="pre">-sx</span> <span class="pre">./build/xclbin_&lt;dsa_name&gt;_&lt;TARGET</span> <span class="pre">mode&gt;/compress_decompress.xclbin</span> <span class="pre">-l</span> <span class="pre">&lt;files.list&gt;</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;files.list&gt;</span></code>: Contains various file names with current path</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<p>The usage of the generated executable is as follows:</p>
<pre class="highlight literal-block"><span></span>Usage: application.exe -<span class="o">[</span>-h-c-d-sx-v-l-k<span class="o">]</span>
     --help,                 -h      Print Help Options   Default: <span class="o">[</span>false<span class="o">]</span>
     --compress,             -c      Compress
     --decompress,           -d      Decompress
     --single_xclbin,        -sx     Single XCLBIN        Default: <span class="o">[</span>single<span class="o">]</span>
     --file_list,            -l      List of Input Files
     --compress_decompress,  -v      Compress Decompress
     --cu,                   -k      CU                   Default: <span class="o">[</span><span class="m">0</span><span class="o">]</span></pre>
</div>
<div class="section" id="software-api-usage">
<h3>Software API Usage<a class="headerlink" href="#software-api-usage" title="Permalink to this headline">¶</a></h3>
<p>This section provides usage information related to software APIs.</p>
<div class="section" id="zlib-compress">
<h4>Zlib Compress<a class="headerlink" href="#zlib-compress" title="Permalink to this headline">¶</a></h4>
<p>Code Snippet below explains the general usage of Zlib compress library.</p>
<pre class="highlight literal-block"><span></span><span class="c1">// Input: Raw File</span>
<span class="c1">// Output: Compress File (.zlib)</span>

<span class="cp">#include</span> <span class="cpf">&quot;zlib.hpp&quot;</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">xf</span><span class="o">::</span><span class="n">compression</span><span class="p">;</span>

<span class="c1">// Create Zlib class object</span>
<span class="c1">// a. Initiate OpenCL device setup</span>
<span class="c1">// b. Load XCLBIN file to FPGA</span>
<span class="c1">// c. Allocate host and device buffers</span>
<span class="n">xfZlib</span><span class="o">*</span> <span class="n">xlz</span><span class="p">;</span>
<span class="n">xlz</span> <span class="o">=</span> <span class="k">new</span> <span class="n">xfZlib</span><span class="p">(</span><span class="n">single_xclbin</span><span class="p">);</span>

<span class="c1">// File I/O operations</span>
<span class="c1">// Invoke FPGA Accelerated Zlib Compress</span>
<span class="c1">// xf::compression::compress()</span>
<span class="kt">uint32_t</span> <span class="n">enc_bytes</span> <span class="o">=</span> <span class="n">xlz</span><span class="o">-&gt;</span><span class="n">compress_file</span><span class="p">(</span><span class="n">inFile</span><span class="p">,</span> <span class="n">outFile</span><span class="p">,</span> <span class="n">input_size</span><span class="p">);</span></pre>
</div>
<div class="section" id="zlib-decompress">
<h4>Zlib Decompress<a class="headerlink" href="#zlib-decompress" title="Permalink to this headline">¶</a></h4>
<p>Code Snippet below explains the general usage of Zlib decompress library.</p>
<pre class="highlight literal-block"><span></span><span class="c1">// Input: Compress File (.zlib)</span>
<span class="c1">// Output: Raw File</span>

<span class="cp">#include</span> <span class="cpf">&quot;zlib.hpp&quot;</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">xf</span><span class="o">::</span><span class="n">compression</span><span class="p">;</span>

<span class="c1">// Create Zlib class object</span>
<span class="c1">// a. Initiate OpenCL device setup</span>
<span class="c1">// b. Load XCLBIN file to FPGA</span>
<span class="c1">// c. Allocate host and device buffers</span>
<span class="n">xfZlib</span><span class="o">*</span> <span class="n">xlz</span><span class="p">;</span>
<span class="n">xlz</span> <span class="o">=</span> <span class="k">new</span> <span class="n">xfZlib</span><span class="p">(</span><span class="n">single_xclbin</span><span class="p">);</span>

<span class="c1">// File I/O operations</span>
<span class="c1">// Internally invokes FPGA Accelerated Zlib Compress</span>
<span class="c1">// xf::compression::decompress()</span>
<span class="kt">uint32_t</span> <span class="n">dec_bytes</span> <span class="o">=</span> <span class="n">xlz</span><span class="o">-&gt;</span><span class="n">decompress_file</span><span class="p">(</span><span class="n">inFile</span><span class="p">,</span> <span class="n">outFile</span><span class="p">,</span> <span class="n">input_size</span><span class="p">);</span></pre>
</div>
<div class="section" id="zlib-shared-library-libz-so">
<h4>Zlib Shared Library (libz.so)<a class="headerlink" href="#zlib-shared-library-libz-so" title="Permalink to this headline">¶</a></h4>
<p>The makefile presented in this demo can be used to create standard
<code class="docutils literal notranslate"><span class="pre">libz.so</span></code> which can be linked against the user applications.</p>
<pre class="highlight literal-block"><span></span><span class="m">1</span>. make lib <span class="o">(</span>To Create libz.so<span class="o">)</span>
<span class="m">2</span>. Location: ./build/libz.so</pre>
<p>Note: This feature is first release it is ideal to use FPGA based compress and
decompress for standard compliance.</p>
</div>
</div>
</div>
<div class="section" id="lz4-application">
<h2>LZ4 Application<a class="headerlink" href="#lz4-application" title="Permalink to this headline">¶</a></h2>
<p>LZ4 data compression application falls under Limpel Ziev based byte compression
scheme. It is widely known for achieving decompression throughput &gt;GB/s on
high end single core high end CPU.</p>
<p>This demo presents usage of FPGA accelerated LZ4 compression &amp;
decompression which achieves throughput &gt;GB/s and this application is scalable.</p>
<div class="section" id="id1">
<h3>Executable Usage<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>This application is present in <code class="docutils literal notranslate"><span class="pre">L3/demos/lz4_app</span></code> directory. Follow build instructions to generate executable and binary.</p>
<p>The binary host file generated is named as “<strong>xil_lz4</strong>” and it is present in <code class="docutils literal notranslate"><span class="pre">./build</span></code> directory.</p>
<ol class="arabic">
<li><p>To execute single file for compression       : <code class="docutils literal notranslate"><span class="pre">./build/xil_lz4</span> <span class="pre">-cx</span> <span class="pre">&lt;compress</span> <span class="pre">xclbin&gt;</span> <span class="pre">-c</span> <span class="pre">&lt;file_name&gt;</span></code></p></li>
<li><p>To execute single file for decompression     : <code class="docutils literal notranslate"><span class="pre">./build/xil_lz4</span> <span class="pre">-dx</span> <span class="pre">&lt;decompress</span> <span class="pre">xclbin&gt;</span> <span class="pre">-d</span> <span class="pre">&lt;file_name.lz4&gt;</span></code></p></li>
<li><p>To validate various files together           : <code class="docutils literal notranslate"><span class="pre">./build/xil_lz4</span> <span class="pre">-cx</span> <span class="pre">&lt;compress</span> <span class="pre">xclbin&gt;</span> <span class="pre">-dx</span> <span class="pre">&lt;decompress</span> <span class="pre">xclbin&gt;</span> <span class="pre">-l</span> <span class="pre">&lt;files.list&gt;</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;files.list&gt;</span></code>: Contains various file names with current path</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<p>The usage of the generated executable is as follows:</p>
<pre class="highlight literal-block"><span></span>Usage: application.exe -<span class="o">[</span>-h-c-l-d-B-x<span class="o">]</span>
     --help,             -h      Print Help Options   Default: <span class="o">[</span>false<span class="o">]</span>
     --compress_xclbin   -cx     Compress binary
     --compress,         -c      Compress
     --file_list,        -l      List of Input Files
     --decompress_xclbin -dx     Decompress binary
     --decompress,       -d      Decompress
     --block_size,       -B      Compress Block Size <span class="o">[</span><span class="m">0</span>-64: <span class="m">1</span>-256: <span class="m">2</span>-1024: <span class="m">3</span>-4096<span class="o">]</span> Default: <span class="o">[</span><span class="m">0</span><span class="o">]</span>
     --flow,             -x      Validation <span class="o">[</span><span class="m">0</span>-All: <span class="m">1</span>-XcXd: <span class="m">2</span>-XcSd: <span class="m">3</span>-ScXd<span class="o">]</span> Default: <span class="o">[</span><span class="m">1</span><span class="o">]</span></pre>
<div class="section" id="lz4-compress">
<h4>LZ4 Compress<a class="headerlink" href="#lz4-compress" title="Permalink to this headline">¶</a></h4>
<p>Code Snippet below explains the general usage of LZ4 compress library.</p>
<pre class="highlight literal-block"><span></span><span class="c1">// Input: Raw File</span>
<span class="c1">// Output: Compress File (.lz4)</span>

<span class="cp">#include</span> <span class="cpf">&quot;lz4.hpp&quot;</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">xf</span><span class="o">::</span><span class="n">compression</span><span class="p">;</span>

<span class="c1">// Create LZ4 class object</span>
<span class="c1">// a. Initiate OpenCL device setup</span>
<span class="c1">// b. Load XCLBIN file to FPGA</span>
<span class="c1">// c. Allocate host and device buffers</span>
<span class="n">xfLz4</span> <span class="n">xlz</span><span class="p">;</span>

<span class="c1">// This variable sets the flows</span>
<span class="c1">// LZ4 Compress or Decompress</span>
<span class="c1">// 1 -&gt; Compress</span>
<span class="n">xlz</span><span class="p">.</span><span class="n">m_bin_flow</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">// XCLBIN file</span>
<span class="c1">// OpenCL setup</span>
<span class="n">xlz</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">binaryFileName</span><span class="p">);</span>

<span class="c1">// Set the block size</span>
<span class="n">xlz</span><span class="p">.</span><span class="n">m_block_size_in_kb</span> <span class="o">=</span> <span class="n">block_size</span>

<span class="c1">// 0 means Xilinx Flow</span>
<span class="n">xlz</span><span class="p">.</span><span class="n">m_switch_flow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">// File I/O operations</span>
<span class="c1">// Internally invokes FPGA Accelerated LZ4 Compress</span>
<span class="c1">// xf::compression::compress()</span>
<span class="kt">uint64_t</span> <span class="n">enc_bytes</span> <span class="o">=</span> <span class="n">xlz</span><span class="p">.</span><span class="n">compressFile</span><span class="p">(</span><span class="n">inFile</span><span class="p">,</span> <span class="n">outFile</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">file_list_flag</span><span class="p">);</span>

<span class="c1">// Release OpenCL objects</span>
<span class="c1">// Release device buffers</span>
<span class="n">xlz</span><span class="p">.</span><span class="n">release</span><span class="p">();</span></pre>
</div>
<div class="section" id="lz4-decompress">
<h4>LZ4 Decompress<a class="headerlink" href="#lz4-decompress" title="Permalink to this headline">¶</a></h4>
<p>Code Snippet below explains the general usage of LZ4 compress library.</p>
<pre class="highlight literal-block"><span></span><span class="c1">// Input: Compressed File (.lz4)</span>
<span class="c1">// Output: Raw File</span>

<span class="cp">#include</span> <span class="cpf">&quot;lz4.hpp&quot;</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">xf</span><span class="o">::</span><span class="n">compression</span><span class="p">;</span>

<span class="c1">// Create LZ4 class object</span>
<span class="c1">// a. Initiate OpenCL device setup</span>
<span class="c1">// b. Load XCLBIN file to FPGA</span>
<span class="c1">// c. Allocate host and device buffers</span>
<span class="n">xfLz4</span> <span class="n">xlz</span><span class="p">;</span>

<span class="c1">// This variable sets the flows</span>
<span class="c1">// LZ4 Compress or Decompress</span>
<span class="c1">// 1 -&gt; Compress</span>
<span class="n">xlz</span><span class="p">.</span><span class="n">m_bin_flow</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">// XCLBIN file</span>
<span class="c1">// OpenCL setup</span>
<span class="n">xlz</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">binaryFileName</span><span class="p">);</span>

<span class="c1">// Set the block size</span>
<span class="n">xlz</span><span class="p">.</span><span class="n">m_block_size_in_kb</span> <span class="o">=</span> <span class="n">block_size</span>

<span class="c1">// 0 means Xilinx Flow</span>
<span class="n">xlz</span><span class="p">.</span><span class="n">m_switch_flow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">// File I/O operations</span>
<span class="c1">// Internally invokes FPGA Accelerated LZ4 Compress</span>
<span class="c1">// xf::compression::compress()</span>
<span class="kt">uint64_t</span> <span class="n">enc_bytes</span> <span class="o">=</span> <span class="n">xlz</span><span class="p">.</span><span class="n">compressFile</span><span class="p">(</span><span class="n">inFile</span><span class="p">,</span> <span class="n">outFile</span><span class="p">,</span> <span class="n">input_size</span><span class="p">,</span> <span class="n">file_list_flag</span><span class="p">);</span>

<span class="c1">// Release OpenCL objects</span>
<span class="c1">// Release device buffers</span>
<span class="n">xlz</span><span class="p">.</span><span class="n">release</span><span class="p">();</span></pre>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../results.html" class="btn btn-neutral float-right" title="Benchmark Results" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../doxygen/L3/rst/class_xf_compression_xfZlib.html" class="btn btn-neutral float-left" title="class xf::compression::xfZlib" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p>
        
        &copy; Copyright 2019, Xilinx

    </p>
  </div>
<!--
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 
-->
</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>