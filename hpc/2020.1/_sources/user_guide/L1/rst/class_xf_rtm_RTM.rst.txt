.. index:: pair: class; xf::rtm::RTM
.. _doxid-classxf_1_1rtm_1_1_r_t_m:
.. _cid-xf::rtm::rtm:

template class xf::rtm::RTM
===========================

.. toctree::
	:hidden:

.. code-block:: cpp
	:class: overview-code-block

	#include "rtm.hpp"


Overview
~~~~~~~~

:ref:`RTM <doxid-classxf_1_1rtm_1_1_r_t_m>` class defines the basic operations for 2D :ref:`RTM <doxid-classxf_1_1rtm_1_1_r_t_m>` .



.. rubric:: Parameters:

.. list-table::
    :widths: 20 80

    *
        - t_DataType

        - the basic wavefield datatype

    *
        - t_Order

        - is the spatial discretization order

    *
        - t_MaxDim

        - is the maximum height this kernel can process

    *
        - t_PE

        - is the number of processing elements

.. _doxid-classxf_1_1rtm_1_1_r_t_m_1aa47a0654f7e3e29fd1e21339c8391ab9:
.. _cid-xf::rtm::rtm::t_pairtype:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a006a8d6fe3b14e3446cb219742fcfa35:
.. _cid-xf::rtm::rtm::t_widetype:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3:
.. _cid-xf::rtm::rtm::t_intype:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a207411fee95232077566d4c23667b8f9:
.. _cid-xf::rtm::rtm::t_pairintype:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a5bc3bb046deff8a6f84823f8baecfd70:
.. _cid-xf::rtm::rtm::t_upbtype:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1ac3ef7031665b3b27c47c627da4947e7e:
.. _cid-xf::rtm::rtm::t_upbintype:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a0afba56002fa3a1ee7a784081a6d7593:
.. _cid-xf::rtm::rtm::rtm:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a5a0bbcdac8a834991bfc33a5b91bd14a:
.. _cid-xf::rtm::rtm::setboundarydim:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a5e28ddf211f2802b1cdd9f1be48e8b55:
.. _cid-xf::rtm::rtm::getzb:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1ae7f9d0da8c8be15168bf36e93554a25b:
.. _cid-xf::rtm::rtm::getxb:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1aa0970f8a488a2f8db1f0a9966f1a79dd:
.. _cid-xf::rtm::rtm::settaper:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a07cbabe964ca50218bb3676de39dab6d:
.. _cid-xf::rtm::rtm::setsrc:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a88148657bfae3e6dab28b18204b84d71:
.. _cid-xf::rtm::rtm::setreceiver:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a1b3fbcfd2e7295b13d33ac5b3b5b6dee:
.. _cid-xf::rtm::rtm::loadupb:
.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a61ab524b5985cd4acdf3c2a8d54ab69f:
.. _cid-xf::rtm::rtm::saveupb:
.. ref-code-block:: cpp
	:class: overview-code-block

	template <
	    typename t_DataType,
	    int t_Order,
	    int t_MaxDim = 1024,
	    int t_MaxB = 40,
	    int t_PE = t_Order / 2
	    >
	class RTM: public :ref:`xf::rtm::Stencil2D<doxid-classxf_1_1rtm_1_1_stencil2_d>`

	// typedefs

	typedef :ref:`Stencil2D<doxid-classxf_1_1rtm_1_1_stencil2_d>` <t_DataType, t_Order, t_MaxDim, t_PE>:::ref:`t_PairType<doxid-classxf_1_1rtm_1_1_r_t_m_1aa47a0654f7e3e29fd1e21339c8391ab9>` t_PairType
	typedef :ref:`Stencil2D<doxid-classxf_1_1rtm_1_1_stencil2_d>` <t_DataType, t_Order, t_MaxDim, t_PE>:::ref:`t_WideType<doxid-classxf_1_1rtm_1_1_r_t_m_1a006a8d6fe3b14e3446cb219742fcfa35>` t_WideType
	typedef t_WideType::t_TypeInt t_InType
	typedef t_PairType::t_TypeInt t_PairInType
	typedef blas::WideType <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`, :ref:`t_HalfOrder<doxid-classxf_1_1rtm_1_1_stencil2_d_1a457febc35a8200c730606f3329c11987>`/t_PE> t_UpbType
	typedef t_UpbType::t_TypeInt t_UpbInType

Inherited Members
-----------------

.. ref-code-block:: cpp
	:class: overview-inherited-code-block

	// typedefs

	typedef blas::WideType <t_DataType, t_PE> :ref:`t_WideType<doxid-classxf_1_1rtm_1_1_stencil2_d_1af21b3a4674c09f904dc597abe856aff7>`
	typedef t_WideType::t_TypeInt :ref:`t_InType<doxid-classxf_1_1rtm_1_1_stencil2_d_1afac22bc21b95320381d4eeb29ffad054>`
	typedef blas::WideType <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_stencil2_d_1afac22bc21b95320381d4eeb29ffad054>`, :ref:`t_NumData<doxid-classxf_1_1rtm_1_1_stencil2_d_1ab31b86003351737745c83923198520f7>`, t_WideType::t_TypeWidth> :ref:`t_PairType<doxid-classxf_1_1rtm_1_1_stencil2_d_1a6c4aaa280892989c4fa6532e3f030ecc>`
	typedef t_PairType::t_TypeInt :ref:`t_PairInType<doxid-classxf_1_1rtm_1_1_stencil2_d_1ac12ea29a4ca2e3173829f4c98d5dce4b>`

	// fields

	static const unsigned int :ref:`t_NumData<doxid-classxf_1_1rtm_1_1_stencil2_d_1ab31b86003351737745c83923198520f7>`
	static const unsigned int :ref:`t_HalfOrder<doxid-classxf_1_1rtm_1_1_stencil2_d_1a457febc35a8200c730606f3329c11987>`
	static const unsigned int :ref:`t_FifoDepth<doxid-classxf_1_1rtm_1_1_stencil2_d_1aff7831789b802dae84b7daed2cb18fc8>`


Methods
~~~~~~~

.. FunctionSection

.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a6da9592c35a3f267fed19ce00c9e08c4:
.. _cid-xf::rtm::rtm::forward:

forward
-------


.. ref-code-block:: cpp
	:class: title-code-block

	void forward (
	    const t_DataType p_src,
	    hls::stream <:ref:`t_UpbInType<doxid-classxf_1_1rtm_1_1_r_t_m_1ac3ef7031665b3b27c47c627da4947e7e>`>& p_upb,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_v2dt2,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_vt,
	    hls::stream <:ref:`t_PairInType<doxid-classxf_1_1rtm_1_1_r_t_m_1a207411fee95232077566d4c23667b8f9>`>& p_p0,
	    hls::stream <:ref:`t_PairInType<doxid-classxf_1_1rtm_1_1_r_t_m_1a207411fee95232077566d4c23667b8f9>`>& p_p1
	    )

forward defines the forward streaming module



.. rubric:: Parameters:

.. list-table::
    :widths: 20 80

    *
        - p_src

        - is the source wavefield at given time stamp

    *
        - p_upb

        - is the upper boundary to be saved

    *
        - p_v2dt2

        - is the pow(v * dt, 2)

    *
        - p_vt

        - is a copy of p_v2dt2

    *
        - p_p0

        - is the stream of input wavefield p(t-1) and p(t)

    *
        - p_p1

        - is the stream of output wavefield p(t) and p(t+1)

.. _doxid-classxf_1_1rtm_1_1_r_t_m_1aafc03bfcb1070de736b2968d3a8d7d5e:
.. _cid-xf::rtm::rtm::backwardf:

backwardF
---------


.. ref-code-block:: cpp
	:class: title-code-block

	void backwardF (
	    hls::stream <:ref:`t_UpbInType<doxid-classxf_1_1rtm_1_1_r_t_m_1ac3ef7031665b3b27c47c627da4947e7e>`>& p_upb,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_v2dt2,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_vt,
	    hls::stream <:ref:`t_PairInType<doxid-classxf_1_1rtm_1_1_r_t_m_1a207411fee95232077566d4c23667b8f9>`>& p_p0,
	    hls::stream <:ref:`t_PairInType<doxid-classxf_1_1rtm_1_1_r_t_m_1a207411fee95232077566d4c23667b8f9>`>& p_p1,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_p,
	    bool p_t = false
	    )

backwardF defines the backward streaming module for source wavefield



.. rubric:: Parameters:

.. list-table::
    :widths: 20 80

    *
        - p_upb

        - is the stream of upper boundary to be restored

    *
        - p_v2dt2

        - is the pow(v * dt, 2)

    *
        - p_vt

        - is a copy of p_v2dt2

    *
        - p_p0

        - is the stream of input wavefield p(t+1) and p(t)

    *
        - p_p1

        - is the stream of output wavefield p(t) and p(t-1)

    *
        - p_p

        - is the stream of wavefield p(t-1) for cross-correlation

.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a8bf33dc6abda92d6fcc19e4729a5bd39:
.. _cid-xf::rtm::rtm::backwardr:

backwardR
---------


.. ref-code-block:: cpp
	:class: title-code-block

	void backwardR (
	    hls::stream <t_DataType>& p_rec,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_v2dt2,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_vt,
	    hls::stream <:ref:`t_PairInType<doxid-classxf_1_1rtm_1_1_r_t_m_1a207411fee95232077566d4c23667b8f9>`>& p_r0,
	    hls::stream <:ref:`t_PairInType<doxid-classxf_1_1rtm_1_1_r_t_m_1a207411fee95232077566d4c23667b8f9>`>& p_r1,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_r
	    )

backwardR defines the backward streaming module for receiver wavefield



.. rubric:: Parameters:

.. list-table::
    :widths: 20 80

    *
        - p_rec

        - is the stream of the data from receivers

    *
        - p_v2dt2

        - is the pow(v * dt, 2)

    *
        - p_vt

        - is a copy of p_v2dt2

    *
        - p_r0

        - is the stream of input wavefield r(t+1) and r(t)

    *
        - p_r1

        - is the stream of output wavefield r(t) and r(t-1)

    *
        - p_r

        - is the stream of wavefield r(t-1) for cross-correlation

.. _doxid-classxf_1_1rtm_1_1_r_t_m_1a4e54d45caa511bf6e1f76de27b773713:
.. _cid-xf::rtm::rtm::crosscorrelation:

crossCorrelation
----------------


.. ref-code-block:: cpp
	:class: title-code-block

	void crossCorrelation (
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_p,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_r,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_imgIn,
	    hls::stream <:ref:`t_InType<doxid-classxf_1_1rtm_1_1_r_t_m_1a01ed41aae0dc5abd645903ed58b119b3>`>& p_imgOut
	    )

crossCorrelation constructs the detecting area images



.. rubric:: Parameters:

.. list-table::
    :widths: 20 80

    *
        - p_p

        - is the stream of wavefield p(t) for cross-correlation

    *
        - p_r

        - is the stream of wavefield r(t) for cross-correlation

    *
        - p_imgIn

        - is the stream of input image

    *
        - p_imgOut

        - is the stream of output image

